angular.module("vgraph",[]),angular.module("vgraph").factory("BoxModel",[function(){"use strict";function t(t,e){var a=e.padding,r=t.padding,n=e.margin,o=t.margin;o||(t.margin=o={top:0,right:0,bottom:0,left:0}),n&&(o.top=i(n.top,o.top),o.right=i(n.right,o.right),o.bottom=i(n.bottom,o.bottom),o.left=i(n.left,o.left)),r||(t.padding=r={top:0,right:0,bottom:0,left:0}),a&&(r.top=i(a.top,r.top),r.right=i(a.right,r.right),r.bottom=i(a.bottom,r.bottom),r.left=i(a.left,r.left)),t.outerWidth=i(e.outerWidth,t.outerWidth)||0,t.outerHeight=i(e.outerHeight,t.outerHeight)||0,t.top=o.top,t.bottom=t.outerHeight-o.bottom,t.left=o.left,t.right=t.outerWidth-o.right,t.center=(t.left+t.right)/2,t.middle=(t.top+t.bottom)/2,t.width=t.right-t.left,t.height=t.bottom-t.top,t.innerTop=t.top+r.top,t.innerBottom=t.bottom-r.bottom,t.innerLeft=t.left+r.left,t.innerRight=t.right-r.right,t.innerWidth=t.innerRight-t.innerLeft,t.innerHeight=t.innerBottom-t.innerTop,t.ratio=t.outerWidth+" x "+t.outerHeight}function e(e){this.registrations=[],t(this,e||{})}function i(t,e){return void 0!==t?parseInt(t):e}return e.prototype.register=function(t){this.ratio&&t(),this.registrations.push(t)},e.prototype.targetSvg=function(t){this.$element=t,this.resize()},e.prototype.resize=function(){var e,i,a=this.$element;if(a.attr("width",null).attr("height",null),a[0].style.cssText=null,t(this,{outerWidth:a.outerWidth(!0),outerHeight:a.outerHeight(!0),margin:{top:a.css("margin-top"),right:a.css("margin-right"),bottom:a.css("margin-bottom"),left:a.css("margin-left")},padding:{top:a.css("padding-top"),right:a.css("padding-right"),bottom:a.css("padding-bottom"),left:a.css("padding-left")}}),a.css("margin","0").css("padding","0").attr("width",this.outerWidth).attr("height",this.outerHeight).css({width:this.outerWidth+"px",height:this.outerHeight+"px"}),this.innerWidth&&this.innerHeight)for(e=0,i=this.registrations.length;i>e;e++)this.registrations[e]()},e}]),angular.module("vgraph").factory("ComponentGenerator",[function(){"use strict";function t(t,e,i){var a,r,n,o=e.name;return t[o]=e,a=angular.isFunction(e.value)?o+".value":"'"+(e.value||o)+"'",r=angular.isFunction(e.interval)?o+".interval":"'"+(e.interval||"x")+"'",angular.isString(e.data)?(n=e.data,t[e.data]=t.$parent[e.data]):n=e.data?o+".data":"data",'<path class="'+i+" "+e.className+'" vgraph-feed="'+n+'" name="'+o+'" value="'+a+'" interval="'+r+'"'+(e.filter?' filter="'+e.filter+'"':"")+"></path>"}var e={require:["^vgraphChart"],link:function(t,e,i,a){function r(){t.data&&c.valueParse&&(d!==t.data||t.data.length!==u)&&(d&&l.removePlot(h),d=t.data,u=0,n(t.data),s.model.dataReady(t))}function n(e){var i=e.length;if(i&&i!==u){for(;i>u;u++)t.loadPoint(t.data[u]);l.dataReady(t)}}var o,s=a[0],l=s.model,c={model:l},d=!1,h=i.name,u=0,f=[],p=parseInt(i.memory,10)||10;t.$watch("interval",function(t){"string"==typeof t?c.intervalParse=function(e){return e[t]}:c.intervalParse=t}),t.$watch("extra",function(t){c.extraParse=t}),t.$watch("filter",function(t){c.filterParse=t}),t.$watch("value",function(t){"string"==typeof t?(o=i.alias||t,c.valueParse=function(e){return void 0!==e[t]?e[o]:void 0}):c.valueParse=t,r()}),t.$watch("data",function(){r()}),t.$watch("data.length",function(e){e&&c.valueParse&&n(t.data)}),t.loadPoint?t.loadPoint=t.loadPoint.bind(c):t.loadPoint=function(t){var e,i=this.valueParse(t);void 0!==i&&(this.filterParse?(f.length>p&&f.shift(),f.push(i),e=this.model.addPoint(h,this.intervalParse(t),this.filterParse(i,f))):e=this.model.addPoint(h,this.intervalParse(t),i),this.extraParse&&e&&this.extraParse(t,e))}.bind(c)},scope:{data:"=_undefined_",value:"=?value",interval:"=?interval",filter:"=?filter",extra:"=?extra"}};return{generate:function(t,i){function a(){}var r;return a.prototype=e,r=new a,r.scope=angular.copy(r.scope),r.scope.data="="+t,angular.forEach(i,function(t,e){var i=r[e];i?angular.isFunction(i)?r[e]=function(){i.apply(this,arguments),t.apply(this,arguments)}:r[e]=angular.extend(i,t):r[e]=t}),r.preLink&&(r.link={pre:r.preLink,post:r.link}),r},makeLineCalc:function(t,e){return d3.svg.line().interpolate("linear").defined(function(t){var i=t[e];return!(isNaN(i)||null===i)}).x(function(e){return t.x.scale(e.$interval)}).y(function(i){return t.y.scale(i[e])})},makeFillCalc:function(t,e,i){return d3.svg.area().defined(function(t){var i=t[e];return!(isNaN(i)||null===i)}).x(function(e){return t.x.scale(e.$interval)}).y(function(i){return t.y.scale(i[e])}).y1(function(e){return t.y.scale(e[i]?e[i]:t.model.y.minimum)})},decodeConfig:function(e,i,a){var r,n,o=[];if(angular.isArray(i))for(r=0,n=i.length;n>r;r++)o.push(t(e,i[r],a));else o.push(t(e,i,a));return o},compileConfig:function(t,e,i){var a,r,n,o;for(angular.isArray(e)||(e=[e]),n=this.decodeConfig(t,e,i),o=(new DOMParser).parseFromString('<g xmlns="http://www.w3.org/2000/svg">'+n.join("")+"</g>","image/svg+xml").childNodes[0].childNodes,a=0,r=o.length;r>a;a++)n[a]={name:e[a].name,className:e[a].className,element:o[a],$d3:d3.select(o[a])};return n},parseStackedLimits:function(t,e){var i,a,r,n,o,s,l,c,d,h;if(e&&e.length)for(i=0,a=t.length;a>i;i++){for(s=0,c=void 0,l=t[i],r=0,n=e.length;n>r&&void 0===c;r++)o=e[r].name,c=l[o],void 0!==c&&(void 0===d?(d=c,h=c):d>c&&(d=c));for(l["$"+o]=c,s=c;n>r;r++)o=e[r].name,c=l[o]||0,s+=c,l["$"+o]=s;l.$total=s,s>h&&(h=s)}return{min:d,max:h}},parseLimits:function(t,e,i){var a,r,n,o,s,l;if(angular.isString(e))if(i)for(a=0,r=t.length;r>a;a++)n=t[a],o=i(n,n[e]),void 0!==o&&(void 0===s?(s=o,l=o):s>o?s=o:o>l&&(l=o));else for(a=0,r=t.length;r>a;a++)n=t[a],o=n[e],void 0!==o&&(void 0===s?(s=o,l=o):s>o?s=o:o>l&&(l=o));else for(a=0,r=e.length;r>a;a++)o=this.parseLimits(t,e[a]),void 0===s?(s=o.min,l=o.max):(o.min<s&&(s=o.min),o.max>l&&(l=o.max));return{min:s,max:l}}}}]),angular.module("vgraph").factory("GraphModel",[function(){"use strict";function t(t,e){return t[r(t,e,1)-1]}function e(t,e){return{$x:e,$interval:t.makeInterval(e)}}function i(t){t||(t={}),t.x||(t.x={}),t.y||(t.y={}),this.queued=null,this.construct(),this.reset(t)}var a=0,r=d3.bisector(function(t){return t.$interval}).left;return i.prototype.construct=function(){var t=this;this.$modelId=a++,this.registrations=[],this.point={reset:function(t){t.$x=null,t.$y=null},isValid:function(e){var i;return void 0===t.x.start?!0:(i=e.$x,t.x.start.$x<=i&&i<=t.x.stop.$x)}}},i.prototype.reset=function(t){this.data=[],this.lookUp={},this.plots={},this.plotNames=[],this.filtered=null,this.needSort=!1,this.ratio=null,this.transitionDuration=30,this.setStatus("loading"),this.config(t||this)},i.prototype.setBounds=function(t,e){return t&&(void 0!==t.min&&(this.x.$min=t.min),void 0!==t.max&&(this.x.$max=t.max)),e&&(void 0!==e.min&&(this.y.$min=e.min),void 0!==e.max&&(this.y.$max=e.max)),this},i.prototype.setPane=function(t,e){return t&&(void 0!==t.start&&(this.x.start=t.start),void 0!==t.stop&&(this.x.stop=t.stop)),e&&(void 0!==e.start&&(this.y.start=e.start),void 0!==e.stop&&(this.y.stop=e.stop)),this},i.prototype.config=function(t){var e=this;this.x={$min:null,$max:null,massage:t.x.massage||null,padding:t.x.padding||0,scale:t.x.scale||function(){return d3.scale.linear()},disp:t.x.display||function(t){return t.$interval},simplify:t.x.simplify||function(t){return t.$x},parse:t.x.parse||function(t){return t.$interval},format:t.x.format||d3.format("03d"),tick:t.x.tick||{}},this.y={$min:null,$max:null,massage:t.y.massage||null,padding:t.y.padding||0,scale:t.y.scale||function(){return d3.scale.linear()},disp:t.y.display||function(t,i){return e.y.parse(t,i)},simplify:t.y.simplify||function(t){return e.y.parse(t)},parse:t.y.parse||function(t,e){return void 0===t||null===t?null:t[e]},format:t.y.format||d3.format(",.2f"),tick:t.y.tick||{}},this.setPane(t.x,t.y)},i.prototype.makeInterval=function(t){return t},i.prototype.getPoint=function(t){var e;return this.x.massage&&(t=this.x.massage(t)),t||0===t?(e=this.lookUp[t],e||(e={$interval:this.makeInterval(t),$x:+t}),e):void 0},i.prototype.addPoint=function(t,e,i){var a,r=this.data,n=this.getPoint(e),o=parseFloat(i);if(n)return e=n.$x,this.y.massage&&(i=this.y.massage(e)),void 0===n.$max?(isFinite(o)&&(n.$min=o,n.$max=o),this.lookUp[e]=n,r.length&&r[r.length-1].$x>e&&(this.needSort=!0),this.data.push(n)):isFinite(o)&&((void 0===n.$min||o<n.$min)&&(n.$min=o),(void 0===n.$max||o>n.$max)&&(n.$max=o)),this.x.min||(this.x.min=n,this.x.max=n),a=this.plots[t],a?a.x.max.$x<n.$x?(a.x.max=n,this.x.max.$x<n.$x&&(this.x.max=n)):a.x.min.$x>n.$x&&(a.x.min=n,n.$x<this.x.min.$x&&(this.x.min=n)):(this.plots[t]=a={x:{min:n,max:n}},this.x.max.$x<n.$x?this.x.max=n:n.$x<this.x.min.$x&&(this.x.min=n)),n[t]=i,n},i.prototype.setError=function(t){this.setStatus("error",t)},i.prototype.setStatus=function(t,e){"error"===t?(this.loaded=!1,this.loading=!1,this.error=e,this.message=null):"loaded"===t?(this.loaded=!0,this.loading=!1,this.error=null,this.message=e):"updating"===t?(this.loaded=!0,this.loading=!0,this.error=null,this.message=e):(this.loaded=!1,this.loading=!0,this.error=null,this.message=e),this.status=t},i.prototype.addPlot=function(t,e,i,a){var r,n,o;if(!this.plots[t])for(r=0,n=e.length;n>r;r++)o=e[r],this.addPoint(t,i(o),a(o))},i.prototype.removePlot=function(t){var e,i,a,r,n,o,s,l,c=this.plots[t];if(c){for(delete this.plots[t],s=Object.keys(this.plots),e=0,i=this.data.length;i>e;e++){if(l=this.data[e],l.$max===l[t]){for(n=void 0,a=0,r=s.length;r>a;a++)o=l[s[a]],"number"==typeof o&&(void 0===n||o>n)&&(n=o);l.$max=n}if(l.$min===l[t]){for(n=void 0,a=0,r=s.length;r>a;a++)o=l[s[a]],"number"==typeof o&&(void 0===n||n>o)&&(n=o);l.$min=n}l[t]=null}if(this.x.min=null,this.x.max=null,this.y.min=null,this.y.max=null,s.length&&this.plots[s[0]]&&this.plots[s[0]].x&&this.plots[s[0]].y)for(this.x.min=this.plots[s[0]].x.min,this.x.max=this.plots[s[0]].x.max,this.y.min=this.plots[s[0]].y.min,this.y.max=this.plots[s[0]].y.max,e=1,i=s.length;i>e;e++)o=s[e],l=this.plots[o],l.min&&l.min.$x<this.x.min.$x?this.x.min=l.min:l.max&&this.x.max.$x<l.max.$x&&(this.x.max=l.max),l.min&&l.min.$min<this.y.min.$min?this.y.min=l.min:l.max&&this.y.max.$max<l.max.$max&&(this.y.max=l.max)}},i.prototype.dataReady=function(t){var e=this;clearTimeout(this.queued),this.queued=setTimeout(function(){e.adjusting||e.adjust(t)},15)},i.prototype.findExtemesY=function(t){var e,i,a,r,n;for(i=0,a=t.length;a>i;i++)e=t[i],(e.$min||0===e.$min)&&(void 0===r?r=e:e.$min<r.$min&&(r=e)),(e.$max||0===e.$max)&&(void 0===n?n=e:e.$max>n.$max&&(n=e));return{min:r,max:n}},i.prototype.register=function(t){this.registrations.push(t)},i.prototype.adjust=function(i){var a,r,n,o,s,l,c=!1,d=this,h=this.data,u=this.x;h.length&&(this.nexAdjust=function(){this.adjusting=!0,this.error=!1,this.needSort&&this.data.sort(function(t,e){return t.$x-e.$x});try{if(null===u.$min&&(u.$min=u.min.$x),null===u.$max)u.$max=u.max.$x;else if("string"==typeof u.$max){if("+"!==u.$max.charAt(0))throw"Unable to handle shift as string";u.$max=parseInt(u.$max.substring(1),10)+u.$min}if("number"==typeof u.start)u.start=this.data[u.start];else{if(u.start)if("string"==typeof u.start)if(c=!0,"%"===u.start.charAt(0))l=u.$min+parseFloat(u.start.substring(1),10)*(u.$max-u.$min);else if("+"===u.start.charAt(0))l=u.$min+parseInt(u.start.substring(1),10);else{if("="!==u.start.charAt(0))throw"Start of pane not properly defined";l=parseInt(u.start.substring(1),10)}else l=u.start.$x;else c=!0,l=u.$min;u.start=l>u.min.$x&&l<u.max.$x?t(this.data,l):e(this,l)}if("number"==typeof u.stop)u.stop=this.data[u.stop];else{if(u.stop)if("string"==typeof u.stop)if(c=!0,"%"===u.stop.charAt(0))l=u.$min+parseFloat(u.stop.substring(1),10)*(u.$max-u.$min);else if("+"===u.stop.charAt(0))l=u.$min+parseInt(u.stop.substring(1),10);else{if("="!==u.stop.charAt(0))throw"End of pane not properly defined";l=parseInt(u.stop.substring(1),10)}else l=u.stop.$x;else c=!0,l=u.$max;u.stop=l>u.min.$x&&l<u.max.$x?t(this.data,l):e(this,l)}if(this.filtered=this.data.filter(function(t,e){var i=t.$x;return u.start.$x<=i&&i<=u.stop.$x?(o?s=e:o=e,t.$inPane=!0,!0):(t.$inPane=!1,!1)}),this.filtered.$first=o,this.filtered.$last=s,u.stop&&u.start&&(n=h.length+" : "+this.filtered.length,n!==this.ratio||i||c))for(this.ratio=n,a=0,r=this.registrations.length;r>a;a++)this.registrations[a](this)}catch(f){d.setError("Model Failed"),f.message?(console.debug(f.message),console.debug(f.stack)):console.debug(f)}this.adjusting=!1},this.adjustInterval||(this.adjustInterval=setTimeout(function(){d.adjustInterval=null,d.nexAdjust()},30)))},i}]),angular.module("vgraph").directive("vgraphAxis",[function(){"use strict";function t(t,e){return!(t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}return{require:["^vgraphChart"],link:function(e,i,a,r){var n,o,s,l,c,d,h,u,f,p,m,g=r[0],v=d3.svg.axis(),x="axis",$=g.box,y=g.model,b=0,k=null,w=!0,C=!1,P=parseInt(a.tickLength)||0,N=parseInt(a.tickPadding)||3,L=parseInt(a.tickMargin)||0,A=d3.select(i[0]);switch(d=A.append("g").attr("class","ticks"),p=A.append("g").attr("class","padding"),h=p.append("g").attr("class","tick-marks"),u=p.append("rect").attr("class","tick-margin"),m=A.append("g").attr("class","label-wrap"),a.tickRotation&&(k=parseInt(a.tickRotation,10)%360),a.labelOffset&&(b=e.$eval(a.labelOffset)),a.labelClean&&(w=e.$eval(a.labelClean)),a.labelEndpoints&&(C=e.$eval(a.labelEndpoints)),a.axisLabel&&(f=m.append("text").attr("class","axis-label label").text(e.$eval(a.axisLabel))),n=function(){a.tickMarks?(v.tickValues(e.$eval(a.tickMarks)),s=[]):a.tickCount?(v.ticks(e.$eval(a.tickCount)),s=[]):(v.ticks(10),s=[])},e.orient){case"top":o=function(){var t;A.attr("class",x+" x top").attr("transform","translate("+$.left+","+$.top+")").attr("width",$.width).attr("height",$.padding.top),f&&f.attr("text-anchor","middle").attr("x",$.width/2).attr("y",$.padding.top-b),L&&u.attr("height",L).attr("width",$.innerWidth).attr("x",0).attr("y",-L),h.attr("transform","translate(-"+$.margin.left+",0)"),s&&(v.orient("top").tickFormat(y.x.format).innerTickSize(-$.innerHeight+P+L).outerTickSize(0).tickPadding(N+P+L).scale(g.x.scale),y.x.tick.interval&&v.ticks(y.x.tick.interval,y.x.tick.step),d.attr("transform","translate(-"+$.margin.left+","+$.padding.top+")").call(v),t=A.selectAll("g.axis-cap").data(g.x.scale.domain()),C&&(t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate("+(g.x.scale(t)-$.margin.left)+",0)"}).select("text").text(function(t){var e=y.x.format(t);return(""+e).match("NaN")?"":e}).attr("dy","-0.25em").attr("y",$.padding.top).attr("text-anchor","middle")),k&&(d.selectAll(".tick text").attr("transform","translate(0,"+d.select(".tick text").attr("y")+") rotate("+k+",0,0)").attr("y","0").style("text-anchor",k%360>0?"end":"start"),t.select("text").attr("transform","rotate("+k+",0,0)").style("text-anchor",e.rotation%360>0?"end":"start")))};break;case"bottom":o=function(){var t;A.attr("class",x+" x bottom").attr("transform","translate("+$.left+","+$.innerBottom+")").attr("width",$.width).attr("height",$.padding.bottom),f&&f.attr("text-anchor","middle").attr("x",$.width/2).attr("y",$.padding.bottom+b),L&&u.attr("height",L).attr("width",$.innerWidth).attr("x",0).attr("y",0),h.attr("transform","translate(-"+$.margin.left+",0)"),s&&(v.orient("bottom").tickFormat(y.x.format).innerTickSize($.innerHeight+P+L).outerTickSize(0).tickPadding(N+P+L).scale(g.x.scale),y.x.tick.interval&&v.ticks(y.x.tick.interval,y.x.tick.step),d.attr("transform","translate(-"+$.margin.left+","+-$.innerHeight+")").call(v),t=A.selectAll("g.axis-cap").data(g.x.scale.domain()),C&&(t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate("+(g.x.scale(t)-$.margin.left)+",0)"}).select("text").text(function(t){var e=y.x.format(t);return(""+e).match("NaN")?"":e}).attr("dy","1em").attr("y",0).attr("text-anchor","middle")),k&&(d.selectAll(".tick text").attr("transform",function(){return"translate(0,"+d3.select(this).attr("y")+") rotate("+k+",0,0)"}).attr("y","0").style("text-anchor",k%360>0?"start":"end"),t.select("text").attr("transform","rotate("+k+",0,0)").style("text-anchor",e.rotation%360>0?"start":"end")))};break;case"right":break;case"left":var F;o=function(){A.attr("class",x+" y left").attr("transform","translate("+$.left+","+$.top+")").attr("width",$.padding.left).attr("height",$.height),m.attr("transform","translate("+$.padding.left+","+$.height+") rotate( -90 )"),f&&f.attr("text-anchor","middle").attr("x",$.height/2).attr("y",-b),L&&u.attr("height",$.innerHeight).attr("width",L).attr("x",-L).attr("y",0),h.attr("transform","translate("+$.padding.left+","+-$.top+")"),s&&(v.orient("left").tickFormat(y.y.format).innerTickSize(-($.innerWidth+P+L)).outerTickSize(0).tickPadding(N+P+L).scale(g.y.scale),y.y.tick.interval&&v.ticks(y.y.tick.interval,y.y.tick.step),d.attr("transform","translate("+($.padding.left-P-L)+","+-$.top+")").call(v),d.select(".domain").attr("transform","translate("+(P+L)+",0)"),C&&(F=A.selectAll("g.axis-cap").data(g.y.scale.domain()),F.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),F.exit().remove(),F.attr("transform",function(t){return"translate(0,"+(g.y.scale(t)-$.margin.top)+")"}).select("text").text(function(t){var e=y.y.format(t);return(""+e).match("NaN")?"":e}).attr("dy",".25em").attr("x",$.padding.left-v.tickPadding()).attr("text-anchor","end")))}}g.register({build:function(){void 0===s&&n(),o()},process:function(){s.length=0,P&&(d.selectAll(".tick text").each(function(t){s.push({el:this,val:t,position:this.getBoundingClientRect()})}),s.sort(function(t,e){var i=t.position.top-e.position.top;return i?i:t.position.left-e.position.left})),w&&(l=A.select(".axis-min text").node(),l&&(l=l.getBoundingClientRect()),c=A.select(".axis-max text").node(),c&&(c=c.getBoundingClientRect()))},finalize:function(){var e,i,a,r,n,o,d={};for(h.selectAll("line").remove(),r=0,n=s.length;n>r;r++)e=!0,i=s[r],a=i.position,w&&l&&(t(a,l)||t(a,c))?(i.el.setAttribute("class","collided"),e=!1):void 0===d.left?(d.left=a.left,d.right=a.right,d.width=a.width,d.top=a.top,d.bottom=a.bottom,d.height=a.height,i.el.setAttribute("class","")):w&&t(a,d)?(i.el.setAttribute("class","collided"),e=!1):(o=!1,a.left<d.left&&(d.left=a.left,o=!0),a.right>d.right&&(d.right=a.right,o=!0),o&&(d.width=d.right-d.left,o=!1),a.top<d.top&&(d.top=a.top,o=!0),a.bottom>d.bottom&&(d.bottom=a.bottom,o=!0),o&&(d.height=d.bottom-d.top),i.el.setAttribute("class",""))}},"axis-"+e.orient)},scope:{orient:"=vgraphAxis",adjust:"=axisAdjust",rotation:"=tickRotation"}}}]),angular.module("vgraph").directive("vgraphBar",["$compile","ComponentGenerator",function(t,e){"use strict";return{require:["^vgraphChart"],scope:{data:"=?vgraphBar",config:"=config"},link:function(i,a,r,n){function o(a){var r,n,o,s;if(a){for(d3.select(h).selectAll("path").remove(),l=e.compileConfig(i,a,"line");c.length;)c.pop().$destroy();for(n=0,o=l.length;o>n;n++)s=l[n],s.$valueField="$"+s.name,n?(h.insertBefore(s.element,l[n-1].element),s.$bottom=l[n-1].$valueField,s.calc=e.makeLineCalc(d,s.$valueField,s.$bottom)):(h.appendChild(s.element),s.calc=e.makeLineCalc(d,s.$valueField)),r=i.$new(),c.push(r),t(s.element)(r)}}function s(t,e,i){var a,r,n,o,s,c,h,m,g,v,x,$,y,b,k,w;for(s=e;i>s;s++)g=t[s],g&&(g.$els=[]);for(n=0,o=l.length;o>n;n++){for(h=l[n],w=l[n].$valueField,c=0,m=0,s=e,r=[];i>s;)g=t[s],g&&void 0!==g[w]&&(c+=g[w],m++,v=g),s++;if(c){for($=d.y.scale(c/m),void 0===y&&(t[e]===v?(y=v._$interval-u/2,b=y+u):(y=t[e]._$interval+f,b=v._$interval-f),y<d.box.innerLeft?y=d.box.innerLeft:t[e-1]&&t[e-1]._$interval>y&&(y=t[e-1]._$interval+f),b>d.box.innerRight?b=d.box.innerRight:t[s]&&t[s]._$interval<b&&(b=t[s]._$interval-f),y>b&&(k=y,y=b,b=k),k=b-y),a=void 0===x?p.append("rect").attr("height",d.y.scale(d.model.y.minimum)-$):p.append("rect").attr("height",x-$),a.attr("class","bar "+h.className).attr("y",$).attr("x",y).attr("width",k),a=a[0][0],s=e;i>s;s++)g=t[s],g&&(g.$els.push(a),g.$bar={center:(y+b)/2,top:c/m});x=$}}}var l,c=[],d=n[0],h=a[0],u=parseInt(r.minWidth||1),f=parseInt(r.padding||1),p=d3.select(h).append("g").attr("class","mount");i.$watchCollection("config",o),d.register({parse:function(t){return e.parseStackedLimits(t,l)},build:function(t){var e,i,a=0,r=d.x.scale(d.model.x.min.$interval),n=d.x.scale(d.model.x.max.$interval),o=n-r,l=f+u,c=o/l,h=t.length/c;for(p.selectAll("rect").remove(),1>h&&(h=1),e=0,i=t.length;i>e;e=Math.floor(a))a+=h,s(t,e,a)},finalize:function(t){var e,i,a;for(e=0,i=l.length;i>e;e++)a=l[e],a.$d3.attr("d",a.calc(t))}})}}}]),angular.module("vgraph").directive("vgraphChart",[function(){"use strict";function t(t,e){e&&(t.$mat=d3.select(e).insert("rect",":first-child"),t.$frame=d3.select(e).insert("rect",":first-child")),t.$mat&&t.innerWidth&&(t.$mat.attr("class","mat").attr("width",t.innerWidth).attr("height",t.innerHeight).attr("transform","translate("+t.innerLeft+","+t.innerTop+")"),t.$frame.attr("class","frame").attr("width",t.width).attr("height",t.height).attr("transform","translate("+t.left+","+t.top+")"))}return{controller:function(e){var i=[],a=[],r=e.model,n=e.box,o=this;return this.register=function(t,e){i.push(t),a.push(e)},this.model=r,this.box=n,this.x={scale:r.x.scale(),calc:function(t){return o.x.scale(r.x.parse(t))},center:function(){return(o.x.calc(r.x.min)+o.x.calc(r.x.max))/2}},this.y={scale:r.y.scale(),calc:function(t){return o.y.scale(r.y.parse(t))},center:function(){return(o.y.calc(r.y.min)+o.y.calc(r.y.max))/2}},n.register(function(){t(n),r.adjust(!0)}),r.register(function(){var t,e,a,s,l,c,d,h;for(h=parseInt(r.filtered.length/n.innerWidth)||1,l=r.filtered.filter(function(t,i){return r.x.start===t||r.x.stop===t||i%h===0?(e=t,t.$sampled=t,!0):(t.$sampled=e,!1)}),c=0,d=i.length;d>c;c++)i[c].parse&&(t=i[c].parse(l,r.filtered),t&&(null!==t.min&&(!a&&0!==a||a>t.min)&&(a=t.min),null!==t.max&&(!s&&0!==s||s<t.max)&&(s=t.max)));for(r.adjustSettings&&r.adjustSettings(r.x.stop.$interval-r.x.start.$interval,s-a,r.filtered.$last-r.filtered.$first),r.y.top=s,r.y.bottom=a,r.y.padding&&(t=(s-a)*r.y.padding,s+=t,a-=t),r.y.minimum=a,r.y.maximum=s,o.x.scale.domain([r.x.start.$interval,r.x.stop.$interval]).range([n.innerLeft,n.innerRight]),o.y.scale.domain([a,s]).range([n.innerBottom,n.innerTop]),c=0,d=l.length;d>c;c++)l[c]._$interval=o.x.scale(l[c].$interval);for(c=0,d=i.length;d>c;c++)i[c].build&&i[c].build(l,r.filtered,r.data);for(c=0,d=i.length;d>c;c++)i[c].process&&i[c].process(l,r.filtered,r.data);for(c=0,d=i.length;d>c;c++)i[c].finalize&&i[c].finalize(l,r.filtered,r.data)}),o},link:function(e,i){e.box.targetSvg(i),t(e.box,i[0]),e.$watch("model.loading",function(t){t?i.addClass("loading"):i.removeClass("loading")}),e.$watch("model.error",function(t){t?i.addClass("hasError"):i.removeClass("hasError")})},restrict:"A",scope:{box:"=vgraphChart",model:"=model"}}}]),angular.module("vgraph").directive("vgraphClassifier",["ComponentGenerator",function(t){"use strict";function e(t,e,i){var a,r;for(a=i.length-1;a>=0;a--)r=i[a],r.$els.length&&(e(r)?$(r.$els).addClass(t):$(r.$els).removeClass(t))}return t.generate("vgraphClassifier",{scope:{classes:"=classes"},preLink:function(t){t.loadPoint=function(t){var e=this.intervalParse(t),i=this.model.getPoint(e);i&&this.valueParse(t,i)}},link:function(t,i,a,r){var n=r[0];n.register({finalize:function(i){var a,r,n,o,s=t.classes,l=Object.keys(s);for(a=0,r=l.length;r>a;a++)n=l[a],o=s[n],e(n,o,i)}})}})}]),angular.module("vgraph").directive("vgraphCompare",["$compile","ComponentGenerator",function(t,e){"use strict";return{require:["^vgraphChart"],scope:{config:"=config"},link:function(i,a,r,n){function o(a){var r,n;if(a&&a.length>1){for(d3.select(u).selectAll("path").remove();d.length;)d.pop().$destroy();n=e.compileConfig(i,a,"line"),s=n[0],s.calc=e.makeLineCalc(h,a[0].name),l=n[1],l.calc=e.makeLineCalc(h,a[1].name),c={$d3:d3.select(u).append("path").attr("class","fill "+a[0].className+"-"+a[1].className),calc:e.makeFillCalc(h,a[0].name,a[1].name)},u.appendChild(s.element),u.appendChild(l.element),r=i.$new(),d.push(r),t(s.element)(r),t(l.element)(r)}}var s,l,c,d=[],h=n[0],u=a[0];i.$watchCollection("config",o),h.register({parse:function(t){var e,i,a,r,n,o,c;for(e=0,i=t.length;i>e;e++)a=t[e],r=a[s.name],n=a[l.name],a.$compare={middle:(r+n)/2,difference:Math.abs(r-n)},n>r?void 0===o?(o=r,c=n):(o>r&&(o=r),n>c&&(c=n)):void 0===o?(o=n,c=r):(o>n&&(o=n),r>c&&(c=r));return{min:o,max:c}},finalize:function(t){s.$d3.attr("d",s.calc(t)),l.$d3.attr("d",l.calc(t)),c.$d3.attr("d",c.calc(t))}})}}}]),angular.module("vgraph").directive("vgraphError",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,a){var r=a[0],n=r.box,o=d3.select(e[0]).attr("class","error-view"),s=o.append("rect").attr("class","outline"),l=o.append("text");t.model=r.model,t.box=n,n.register(function(){if(n.innerHeight){s.attr("transform","translate("+n.innerLeft+","+n.innerTop+")").attr("width",n.innerWidth).attr("height",n.innerHeight);try{l.attr("text-anchor","middle").attr("x",n.center).attr("y",n.middle+l.node().getBBox().height/2)}catch(t){l.attr("text-anchor","middle").attr("x",n.center).attr("y",n.middle)}}}),t.$watch("model.error",function(t){t?(o.attr("visibility","visible"),l.text(t)):o.attr("visibility","hidden")})}}}]),angular.module("vgraph").directive("vgraphFeed",["ComponentGenerator",function(t){"use strict";return t.generate("vgraphFeed",{restrict:"A"})}]),angular.module("vgraph").directive("vgraphFill",["ComponentGenerator",function(t){"use strict";return t.generate("vgraphFill",{link:function(e,i,a,r){var n=r[0],o=a.name,s=d3.select(i[0]).append("path").attr("class","fill plot-"+o),l=d3.svg.area().defined(function(t){var e=t[o];return!(isNaN(e)||null===e)}).x(function(t){return n.x.scale(t.$interval)}).y(function(t){return n.y.scale(t[o])}).y1(function(){return n.y.scale(void 0===e.fillTo?n.model.y.bottom:"object"==typeof e.fillTo?e.fillTo.$min:e.fillTo)});n.register({parse:function(e){return t.parseLimits(e,o)},finalize:function(t){s.attr("d",l(t))}})},scope:{data:"=vgraphFill",fillTo:"=fillTo",value:"=value",interval:"=interval",filter:"=filter"}})}]),angular.module("vgraph").directive("vgraphFocus",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,a){var r=a[0],n=r.box,o=d3.select(e[0]),s=o.append("rect").attr("class","focus").attr("visibility","hidden");n.register(function(){s.attr("height",n.innerHeight).attr("y",n.innerTop)}),t.$watch("follow",function(t){var e,i,a;t&&void 0!==t.xDiff&&(e=Math.abs(t.xDiff),i=t.x0-e,a=t.x0+e,s.attr("visibility","visible"),i>n.innerLeft?s.attr("x",i):(i=n.innerLeft,s.attr("x",n.innerLeft)),a>n.innerRight?s.attr("width",n.innerRight-i):s.attr("width",a-i))}),t.$watch("stop",function(e){var i,a,o,l,c,d=r.model;e&&d.filtered&&(a=d.filtered.$first,i=d.filtered.$last-a,s.attr("visibility","hidden"),o=Math.abs(e.xDiff),o>5&&(l=e.x0-o,c=e.x0+o,l<n.innerLeft?l=0:l-=n.innerLeft,c>n.innerRight?c=n.innerWidth:c-=n.innerLeft,d.setPane({start:"="+(d.x.start.$x+l/n.innerWidth*(d.x.stop.$x-d.x.start.$x)),stop:"="+(d.x.start.$x+c/n.innerWidth*(d.x.stop.$x-d.x.start.$x))},{start:null,stop:null}),d.adjust(t)))})},scope:{follow:"=vgraphFocus",stop:"=loseFocus"}}}]),angular.module("vgraph").directive("vgraphIcon",["ComponentGenerator",function(t){"use strict";return t.generate("vgraphIcon",{scope:{getValue:"=trueValue"},link:function(e,i,a,r){var n,o,s,l=r[0],c=i[0],d=a.name,h=[],u=d3.select(c),f=u.node().getBBox();for(void 0===a.value&&(e.value=d),n=0,o=c.childNodes.length;o>n;n++)1===c.childNodes[n].nodeType&&h.push(c.childNodes[n]);i.html(""),l.register({parse:function(e,i){return s=[],t.parseLimits(i,d,function(t,e){e&&s.push(t)})},build:function(){function t(){return this.appendChild(h[o].cloneNode(!0))}var r,n,o,c;i.html(""),angular.forEach(s,function(i){var s;for(r=i.$sampled._$interval,n=l.y.scale(e.getValue(i.$sampled)),s=u.append("g"),o=0,c=h.length;c>o;o++)s.select(t);a.showUnder?s.attr("transform","translate("+(r-f.width/2)+","+n+")"):s.attr("transform","translate("+(r-f.width/2)+","+(n-f.height)+")")})}})}})}]),angular.module("vgraph").directive("vgraphIndicator",[function(){"use strict";return{require:["^vgraphChart"],scope:{model:"=model"},link:function(t,e,i,a){var r,n=a[0],o=i.vgraphIndicator,s=n.model,l=t.$eval(i.pointRadius)||3,c=t.$eval(i.outerRadius),d=d3.select(e[0]).attr("transform","translate(1000,1000)"),h=d.append("circle").attr("class","point inner").attr("r",l).attr("visibility","hidden"),u=d.append("circle").attr("class","point outer").attr("r",l).attr("visibility","hidden");c&&(r=function(){u.transition().duration(1e3).attr("r",c).transition().duration(1e3).attr("r",l).ease("sine").each("end",function(){setTimeout(function(){r()},3e3)})})(),n.register({finalize:function(){var t,e,i;s.plots[o]?(t=s.plots[o].x.max,s.point.isValid(t)&&t[o]?(e=n.x.scale(t.$interval),i=n.y.scale(t["$"+o]||t[o]),h.attr("visibility","visible"),u&&u.attr("visibility","visible"),d.transition().duration(s.transitionDuration).ease("linear").attr("transform","translate("+e+","+i+")")):(h.attr("visibility","hidden"),u&&u.attr("visibility","hidden"))):(h.attr("visibility","hidden"),u&&u.attr("visibility","hidden"))}})}}}]),angular.module("vgraph").directive("vgraphInteract",[function(){"use strict";function t(t,e,i,a){var r,n,o=0,s=t.length-1;if(a||t.sort(function(t,e){return i(t)-i(e)}),i(t[o])>=e)return{left:o,right:o};if(i(t[s])<=e)return{left:s,right:s};if(t.length){for(;s-o>1;)r=Math.floor((s+o)/2),n=i(t[r]),n===e?(s=r,o=r):n>e?s=r:o=r;return s!==r&&i(t[s])===e?{left:s,right:s}:o!==r&&i(t[o])===e?{left:o,right:o}:{left:o,right:s}}}function e(e,i){var a=t(e,i,function(t){return t.$interval},!0),r=i-e[a.left].$interval,n=e[a.right].$interval-i;return n>r?a.left:a.right}return{require:["^vgraphChart"],scope:{highlight:"=vgraphInteract",dragStart:"=?dBegin",dragPos:"=?dChange",dragStop:"=?dEnd"},link:function(t,i,a,r){function n(e,i){clearTimeout(c),t.$apply(function(){var a=d3.mouse(e);t.highlight.point&&$(t.highlight.point.$els).removeClass("active"),t.highlight.point=i,t.highlight.position={x:a[0],y:a[1]},i&&$(i.$els).addClass("active")})}function o(){c=setTimeout(function(){t.$apply(function(){t.highlight.point&&$(t.highlight.point.$els).removeClass("active"),t.highlight.point=null})},100)}var s,l,c,d=r[0],h=!1,u=d.model,f=d.box,p=d3.select(i[0]),m=p.append("rect").style("opacity","0").attr("class","focal").on("mousemove",function(){var t,i;h||(t=d.x.scale.invert(d3.mouse(this)[0]),i=e(s,t),n(this,s[i]))}).on("mouseout",function(t){h||o(this,t)});p.attr("class","interactive"),p.call(d3.behavior.drag().on("dragstart",function(){l=d3.mouse(i[0]),h=!0,o(),t.dragStart={x:l[0],y:l[1]},t.$apply()}).on("dragend",function(){var e=d3.mouse(i[0]);h=!1,t.dragStop={x0:l[0],y0:l[1],x1:e[0],x2:e[1],xDiff:e[0]-l[0],yDiff:e[1]-l[1]},t.$apply()}).on("drag",function(){var e=d3.mouse(i[0]);t.dragPos={x0:l[0],y0:l[1],x1:e[0],x2:e[1],xDiff:e[0]-l[0],yDiff:e[1]-l[1]},t.$apply()})),p.on("dblclick",function(){u.setPane({start:null,stop:null},{start:null,stop:null}),u.adjust()}),d.register({build:function(){},finalize:function(t){s=t,m.attr({x:f.innerLeft,y:f.innerTop,width:f.innerWidth,height:f.innerHeight})}}),t.highlight||(t.highlight={}),t.dragStart||(t.dragStart={}),t.dragPos||(t.dragPos={}),t.dragStop||(t.dragStop={})}}}]),angular.module("vgraph").directive("vgraphLeading",[function(){"use strict";return{require:["^vgraphChart"],scope:{config:"=config"},link:function(t,e,i,a){function r(t){var e,i,a;if(n={},s.selectAll("line").remove(),t)for(i=0,a=t.length;a>i;i++)e=t[i],n[e.name]=s.append("line").attr("class",e.className)}var n,o=a[0],s=d3.select(e[0]);t.$watchCollection("config",r),o.register({finalize:function(){var t,e,i=o.model,a=[];angular.forEach(n,function(e,r){i.plots[r]&&(t=i.plots[r].x.max,i.point.isValid(t)&&t[r]&&a.push({el:e,x:o.x.scale(t.$interval),y:o.y.scale(t["$"+r]||t[r])}));
}),a.sort(function(t,e){return t.y-e.y}),angular.forEach(a,function(t){e&&e.el.attr("x1",e.x).attr("x2",t.x).attr("y1",e.y).attr("y2",t.y),e=t}),e?(s.style("visibility","visible"),e.el.attr("x1",e.x).attr("x2",e.x).attr("y1",e.y).attr("y2",o.box.innerBottom)):s.style("visibility","hidden")}})}}}]),angular.module("vgraph").directive("vgraphLine",["ComponentGenerator",function(t){"use strict";return t.generate("vgraphLine",{link:function(e,i,a,r){var n=r[0],o=a.name,s=d3.select(i[0]).append("path").attr("class","line plot-"+o),l=t.makeLineCalc(n,o);n.register({parse:function(e){return t.parseLimits(e,o)},finalize:function(t){var e;s.attr("d",l(t.filter(function(i,a){var r,n=e;return e=i[o],n!==e?!0:(r=t[a+1],!r||r[o]!==e)})))}})}})}]),angular.module("vgraph").directive("vgraphLoading",["$interval",function(t){"use strict";return{require:["^vgraphChart"],link:function(e,i,a,r){function n(){f||(f=!0,t.cancel(l),s(),l=t(s,4005))}function o(){f=!1,t.cancel(l)}function s(){x.attr("x",function(){return c}).attr("width",function(){return 0}).transition().duration(1e3).attr("x",function(){return c}).attr("width",function(){return d}).ease("sine").transition().duration(1e3).attr("width",0).attr("x",function(){return h}).ease("sine").transition().duration(1e3).attr("width",function(){return d}).attr("x",function(){return c}).ease("sine").transition().duration(1e3).attr("x",function(){return c}).attr("width",0).ease("sine")}var l,c,d,h,u=r[0],f=!1,p=u.box,m=a.vgraphLoading,g=d3.select(i[0]).attr("class","loading-view"),v=g.append("rect").attr("height",20).attr("class","outline"),x=g.append("rect").attr("width",0).attr("height",20).attr("class","filling"),$=g.append("text").text(m);e.model=u.model,p.register(function(){if(c=p.innerLeft+p.innerWidth/5,d=3*p.innerWidth/5,h=c+d,d){x.attr("x",c).attr("y",p.middle-10),v.attr("x",c).attr("y",p.middle-10).attr("width",d);try{$.attr("text-anchor","middle").attr("x",p.center).attr("y",p.middle+$.node().getBBox().height/2-2)}catch(t){$.attr("text-anchor","middle").attr("x",p.center).attr("y",p.middle)}n()}else o()}),e.$on("$destroy",function(){o()}),e.$watch("model.loading",function(t){o(),t&&e.box.ratio&&n()})}}}]),angular.module("vgraph").directive("vgraphMultiIndicator",["$compile",function(t){"use strict";return{scope:{config:"=config"},link:function(e,i,a){function r(i){var r,s,l,c,d,h,u,f,p=e.$eval(a.pointRadius)||3,m=e.$eval(a.outerRadius),g="";if(i){for(d3.select(o).selectAll("g").remove();n.length;)n.pop().$destroy();for(l=0,c=i.length;c>l;l++)f=i[l],u=f.name,d=f.className?f.className:"plot-"+u,g+='<g class="'+d+'" vgraph-indicator="'+u+'"'+(m?' outer-radius="'+m+'"':"")+' point-radius="'+p+'"></g>';for(h=(new DOMParser).parseFromString('<g xmlns="http://www.w3.org/2000/svg">'+g+"</g>","image/svg+xml").childNodes[0].childNodes;h.length;)s=h[0],o.appendChild(s),r=e.$new(),n.push(r),t(s)(r)}}var n=[],o=i[0];e.$watchCollection("config",r)}}}]),angular.module("vgraph").directive("vgraphMultiLine",["$compile","ComponentGenerator",function(t,e){"use strict";return{require:["^vgraphChart"],scope:{data:"=vgraphMultiLine",config:"=config"},link:function(i,a,r,n){function o(a){var r,n,o,u;if(l=[],a){for(d3.select(h).selectAll("path").remove();c.length;)c.pop().$destroy();for(s=e.compileConfig(i,a,"line"),n=0,o=s.length;o>n;n++)u=s[n],h.appendChild(u.element),u.calc=e.makeLineCalc(d,u.name),l.push(u.name),r=i.$new(),c.push(r),t(u.element)(r)}}var s,l,c=[],d=n[0],h=a[0];i.$watchCollection("config",o),d.register({parse:function(t){return e.parseLimits(t,l)},finalize:function(t){var e,i,a;for(e=0,i=s.length;i>e;e++)a=s[e],a.$d3.attr("d",a.calc(t))}})}}}]),angular.module("vgraph").directive("vgraphMultiTooltip",["$compile",function(t){"use strict";return{scope:{config:"=config",formatter:"=textFormatter",data:"=vgraphMultiTooltip"},link:function(e,i,a){function r(i){var r,s,l,c,d,h,u,f,p="";if(i){for(d3.select(o).selectAll("g").remove();n.length;)n.pop().$destroy();for(l=0,c=i.length;c>l;l++)f=i[l],u=f.name,d=f.className?f.className:"plot-"+u,p+='<g class="'+d+'" vgraph-tooltip="data" name="'+u+'" text-formatter="formatter"'+(a.offseX?' offset-x="'+a.offsetX+'"':"")+(a.offseY?' offset-y="'+a.offsetY+'"':"")+"></g>";for(h=(new DOMParser).parseFromString('<g xmlns="http://www.w3.org/2000/svg">'+p+"</g>","image/svg+xml").childNodes[0].childNodes;h.length;)s=h[0],o.appendChild(s),r=e.$new(),n.push(r),t(s)(r)}}var n=[],o=i[0];e.$watchCollection("config",r)}}}]),angular.module("vgraph").directive("vgraphStack",["$compile","ComponentGenerator",function(t,e){"use strict";return{require:["^vgraphChart"],scope:{config:"=config"},link:function(i,a,r,n){function o(a){var r,n,o,h;if(a){for(d3.select(d).selectAll("path").remove(),s=e.compileConfig(i,a,"fill");l.length;)l.pop().$destroy();for(n=0,o=s.length;o>n;n++)h=s[n],h.$valueField="$"+h.name,n?(d.insertBefore(h.element,s[n-1].element),h.$bottom=s[n-1].$valueField,h.calc=e.makeFillCalc(c,h.$valueField,h.$bottom)):(d.appendChild(h.element),h.calc=e.makeFillCalc(c,h.$valueField)),r=i.$new(),l.push(r),t(h.element)(r)}}var s,l=[],c=n[0],d=a[0];i.$watchCollection("config",o),c.register({parse:function(t){return e.parseStackedLimits(t,s)},finalize:function(t){var e,i,a;for(e=0,i=s.length;i>e;e++)a=s[e],a.$d3.attr("d",a.calc(t))}})}}}]),angular.module("vgraph").directive("vgraphTarget",[function(){"use strict";return{require:["^vgraphChart"],scope:{target:"=vgraphTarget",pointRadius:"=pointRadius",config:"=?config"},link:function(t,e,i,a){function r(t){var e,i;if(n={},t)for(e=0,i=t.length;i>e;e++)n[t[e].name]=t[e].className}var n,o=a[0],s=o.model,l=o.box,c=d3.select(e[0]).attr("class","target"),d=c.append("line").attr("class","focus").attr("x1",0).attr("x2",0),h=c.append("g");l.register(function(){d.attr("y1",l.innerTop).attr("y2",l.innerBottom)}),t.$watch("target.point",function(e){var a,r;if(e&&void 0===i.noDots){h.selectAll("circle.point").remove(),c.style("visibility","visible").attr("transform","translate( "+o.x.scale(e.$interval)+" , 0 )");for(a in s.plots)e[a]&&(r=n[a]||"plot-"+a,h.append("circle").attr("class","point "+r).attr("x",0).attr("cy",o.y.scale(e[a])).attr("r",t.$eval(i.pointRadius)||3))}else c.style("visibility","hidden")}),t.$watchCollection("config",r)}}}]),angular.module("vgraph").directive("vgraphTooltip",[function(){"use strict";return{require:["^vgraphChart"],scope:{formatter:"=textFormatter",data:"=vgraphTooltip",value:"=?value"},link:function(t,e,i,a){var r=a[0],n=i.name,o=r.model,s=t.formatter||function(t){return o.y.format(o.y.parse(t))},l=parseInt(i.offsetX)||0,c=parseInt(i.offsetY)||0,d=d3.select(e[0]).attr("class","tooltip"),h=d.append("polygon").attr("class","outline").attr("transform","translate(0,-15)"),u=d.append("text").style("line-height","20").style("font-size","16").attr("class","label");t.$watch("data.point",function(e){var i,a,f,p;e&&(i=t.value?t.value(e):e[n],void 0!==i&&(a=r.y.scale(i),f=r.x.scale(e.$interval)+l,u.text(s(i,e)),p=u.node().getComputedTextLength()+5,d.style("visibility","visible"),f+p+16<r.x.scale(o.x.stop.$interval)?(d.attr("transform","translate("+f+","+(a+c)+")"),u.attr("transform","translate(10,5)"),h.attr("points","0,15 10,0 "+(p+10)+",0 "+(p+10)+",30 10,30 0,15")):(d.attr("transform","translate("+(f-2*l-p-10)+","+(a+c)+")"),u.attr("transform","translate(5,5)"),h.attr("points","0,0 "+p+",0 "+(p+10)+",15 "+p+",30 0,30 0,0")))),void 0===i&&d.style("visibility","hidden")})}}}]),angular.module("vgraph").directive("vgraphZone",["ComponentGenerator",function(t){"use strict";return t.generate("vgraphZone",{link:function(t,e,i,a){var r=a[0],n=i.name,o=d3.select(e[0]).append("path").attr("class","line plot-"+n),s=d3.svg.area().defined(function(t){return t[n]===!0}).x(function(t){return r.x.scale(t.$interval)}).y(function(){return r.box.innerTop}).y1(function(){return r.box.innerBottom});r.register({finalize:function(t){o.attr("d",s(t))}})}})}]),angular.module("vgraph").directive("vgraphZoom",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,a){function r(e){0===o&&s===h.innerWidth?(f=!1,x.attr("class","focus")):(f=!0,x.attr("class","focus zoomed")),0>o&&(o=0),s>h.innerWidth&&(s=h.innerWidth),o>s?o=s:o>s&&(s=o),m.attr("transform","translate("+o+",0)"),g.attr("transform","translate(-"+o+",0 )").attr("width",o),$.attr("transform","translate("+s+",0)"),y.attr("width",h.innerWidth-s),x.attr("transform","translate("+o+",0)").attr("width",s-o),e||t.$apply(function(){var e=t.model;e.setPane({start:"%"+o/h.innerWidth,stop:"%"+s/h.innerWidth},{start:null,stop:null}),e.adjust(t)})}var n,o,s,l,c,d=a[0],h=d.box,u=!1,f=!1,p=d3.select(e[0]),m=p.append("g").attr("class","left-control min-control"),g=m.append("rect").attr("class","shade"),v=m.append("g").attr("class","control"),x=p.append("rect").attr("class","focus"),$=p.append("g").attr("class","right-control max-control"),y=$.append("rect").attr("class","shade"),b=$.append("g").attr("class","control");v.append("path").attr("d","M-0.5,23.33A6,6 0 0 0 -6.5,29.33V40.66A6,6 0 0 0 -0.5,46.66ZM-2.5,31.33V38.66M-4.5,31.33V38.66").attr("transform","translate(0,-9)").attr("class","nub"),l=v.append("rect").attr("width","10").attr("transform","translate(-10,0)"),b.append("path").attr("d","M0.5,23.33A6,6 0 0 1 6.5,29.33V40.66A6,6 0 0 1 0.5,46.66ZM2.5,31.33V38.66M4.5,31.33V38.66").attr("transform","translate(0,-9)").attr("class","nub"),c=b.append("rect").attr("width","10"),t.box=h,l.call(d3.behavior.drag().on("dragstart",function(){u=!0}).on("dragend",function(){u=!1}).on("drag",function(){o=d3.mouse(e[0])[0],r()})),c.call(d3.behavior.drag().on("dragstart",function(){u=!0}).on("dragend",function(){u=!1}).on("drag",function(){s=d3.mouse(e[0])[0],r()})),x.call(d3.behavior.drag().on("dragstart",function(){n={mouse:d3.mouse(e[0])[0],minPos:o,maxPos:s,min:t.model.x.start.$x,max:t.model.x.stop.$x},u=!0}).on("dragend",function(){u=!1,f=!0}).on("drag",function(){var t=d3.mouse(e[0]),i=t[0]-n.mouse;f?(s=n.maxPos+i,o=n.minPos+i,r()):i>5&&(s=n.mouse+Math.abs(i),o=n.mouse-Math.abs(i),r(),f=!1)})),p.on("dblclick",function(){s=h.innerWidth,o=0,r()}),h.register(function(){p.attr("width",h.innerWidth).attr("height",h.innerHeight).attr("transform","translate("+h.innerLeft+","+h.innerTop+")"),g.attr("height",h.innerHeight),y.attr("height",h.innerHeight),l.attr("height",h.innerHeight),c.attr("height",h.innerHeight),x.attr("height",h.innerHeight)}),t.model.register(function(){var e,i,a,n=t.model;u||(e=n.x,i=void 0===t.min?e.$min:t.min,a=void 0===t.max?e.$max:t.max,o=(e.start.$x-i)/(a-i)*h.innerWidth,s=(e.stop.$x-i)/(a-i)*h.innerWidth,r(!0))})},scope:{model:"=vgraphZoom",min:"=zoomMin",max:"=zoomMax"}}}]),function(t){"use strict";var e=/\S+/g,i=/[\t\r\n\f]/g;t&&(t.fn.addClass=function(a){var r,n,o,s,l,c,d,h="string"==typeof a&&a,u=0,f=this.length;if(t.isFunction(a))return this.each(function(e){t(this).addClass(a.call(this,e,this.className))});if(h)for(r=(a||"").match(e)||[];f>u;u++)if(n=this[u],d="string"!=typeof n.className,o=1===n.nodeType&&(n.className?(" "+(d?n.getAttribute("class")||"":n.className)+" ").replace(i," "):" ")){for(l=0;s=r[l++];)o.indexOf(" "+s+" ")<0&&(o+=s+" ");c=t.trim(o),n.className!==c&&(d?n.setAttribute("class",c):n.className=c)}return this},t.fn.removeClass=function(a){var r,n,o,s,l,c,d,h=0===arguments.length||"string"==typeof a&&a,u=0,f=this.length;if(t.isFunction(a))return this.each(function(e){t(this).removeClass(a.call(this,e,this.className))});if(h)for(r=(a||"").match(e)||[];f>u;u++)if(n=this[u],d="string"!=typeof n.className,o=1===n.nodeType&&(n.className?(" "+(d?n.getAttribute("class")||"":n.className)+" ").replace(i," "):"")){for(l=0;s=r[l++];)for(;o.indexOf(" "+s+" ")>=0;)o=o.replace(" "+s+" "," ");c=a?t.trim(o):"",n.className!==c&&(d?n.setAttribute("class",c):n.className=c)}return this})}(jQuery);
//# sourceMappingURL=vgraph.min.js.map