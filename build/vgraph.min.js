angular.module("vgraph",[]),angular.module("vgraph").factory("DomHelper",[function(){"use strict";function t(t){var i=e[t];return i||(i=new RegExp("(?:^|\\s)"+t+"(?!\\S)"),e[t]=i),i}var e={};return{bringForward:function(t){var e,i,n;for(e=0,i=t.length;i>e;e++)n=t[e].$element,n.parentNode&&n.parentNode.appendChild(n);return this},addClass:function(e,i){var n,r,a,o,s=t(i);for(n=0,r=e.length;r>n;n++)a=e[n].$element,o=a.getAttribute("class")||"",o.match(s)||a.setAttribute("class",o+" "+i);return this},removeClass:function(e,i){var n,r,a,o=t(i);for(n=0,r=e.length;r>n;n++)a=e[n].$element,a.setAttribute("class",(a.getAttribute("class")||"").replace(o,""));return this}}}]),angular.module("vgraph").factory("makeEventing",[function(){"use strict";return function(t){t.$on=function(t,e){var i=this;return this._$listeners||(this._$listeners={}),this._$listeners[t]||(this._$listeners[t]=[]),this._$listeners[t].push(e),function(){i._$listeners[t].splice(i._$listeners[t].indexOf(e),1)}},t.$subscribe=function(t){var e=this,i=[],n=Object.keys(t);return n.forEach(function(n){var r=t[n];i.push(e.$on(n,r))}),function(){i.forEach(function(t){t()})}},t.$trigger=function(t,e){var i,n,r;if(this._$listeners&&(i=this._$listeners[t]))for(n=0,r=i.length;r>n;n++)i[n](e)}}}]),angular.module("vgraph").factory("Hitbox",[function(){"use strict";function t(t,e,i,n,r){var a,o,s,c,h,l=[],u=[],f=[];for(this.xMin=t,this.xDiff=e-t,this.yMin=i,this.yDiff=n-i,this.count=r,a=0,o=r;o>a;a++)for(h=[],l.push(h),u.push([]),f.push([]),s=0,c=r;c>s;s++)h.push([]);this._index=l,this._xDex=u,this._yDex=f}function e(t,e,i,n){var r,a,o,s=[];for(r=0,a=t.length;a>r;r++)o=t[r],n(o)(e,i)&&s.push(o);return s}var i=0;t.prototype.$hashX=function(t){var e=(t-this.xMin)/this.xDiff*this.count|0;return 0>e?e=0:e>=this.count&&(e=this.count-1),e},t.prototype.$hashY=function(t){var e=(t-this.yMin)/this.yDiff*this.count|0;return 0>e?e=0:e>=this.count&&(e=this.count-1),e},t.prototype.add=function(t){var e,n,r,a,o,s,c=this._index;for(t.x1>t.x2&&(o=t.x1,t.x1=t.x2,t.x2=o),t.y1>t.y2&&(o=t.y1,t.y1=t.y2,t.y2=o),t.$uid=i++,e=this.$hashX(t.x1),n=this.$hashX(t.x2)+1,o=this.$hashY(t.y1),a=this.$hashY(t.y2)+1,r=o;a>r;r++)this._yDex[r].push(t);for(;n>e;e++)for(s=c[e],this._xDex[e].push(t),r=o;a>r;r++)s[r].push(t)};var n={intersect:function(t,e){return this.x1<=t&&this.x2>=t&&this.y1<=e&&this.y2>=e},intersectX:function(t){return this.x1<=t&&this.x2>=t},intersectY:function(t,e){return this.y1<=e&&this.y2>=e}};return t.prototype.checkHit=function(t,i){return e(this._index[this.$hashX(t)][this.$hashY(i)],t,i,function(t){return(t.intersect?t.intersect:n.intersect).bind(t)})},t.prototype.checkX=function(t){return e(this._xDex[this.$hashX(t)],t,null,function(t){return(t.intersectX?t.intersectX:n.intersectX).bind(t)})},t.prototype.checkY=function(t){return e(this._yDex[this.$hashY(t)],null,t,function(t){return(t.intersectY?t.intersectY:n.intersectY).bind(t)})},t}]),angular.module("vgraph").factory("Scheduler",[function(){"use strict";function t(){this.$scripts={},this.$master=this.schedule=[]}function e(){return+new Date}return t.prototype.startScript=function(t){t?this.$scripts[t]?(this.schedule=this.$scripts[t],this.schedule.length=0):this.schedule=this.$scripts[t]=[]:this.schedule=[]},t.prototype.endScript=function(t,e,i){this.schedule.push({$end:!0,always:t,success:e,failure:i}),this.$master.push(this.schedule),this.schedule=this.$master},t.prototype.loop=function(t,e,i){this.schedule.push({start:0,stop:t.length,data:t,op:e,ctx:i})},t.prototype.func=function(t,e){this.schedule.push({op:t,ctx:e})},t.prototype.run=function(){var t=this;this.$lock||(this.$lock=!0,setTimeout(function(){t.$eval()},5))},t.prototype.$eval=function(){function t(){a.$eval()}var i,n,r,a=this,o=!0,s=e(),c=s+500;try{for(;(r=this.schedule.shift())&&o;){if(r.length)for(;r.length;)this.schedule.unshift(r.pop());else if("start"in r)for(i=r.start,n=r.stop;n>i;i++)r.op.call(r.ctx,r.data[i],i);else r.$end?(r.success&&r.success(),r.always&&r.always()):r.op.call(r.ctx);e()>c&&(o=!1,setTimeout(t,5))}}catch(h){for(console.log(h),o=!0;(r=this.schedule.shift())&&o;)r.$end&&(r.failure&&r.failure(),r.always&&r.always(),t())}this.schedule.length||(this.$lock=!1)},t}]),angular.module("vgraph").factory("makeBlob",["svgColorize",function(t){"use strict";function e(t){return t.map(function(t){return'"'+t.join('","')+'"'}).join("\n")}function i(t){for(var e=atob(t.toDataURL("image/png").split(",")[1]),i=e.length,n=new Uint8Array(i),r=0;i>r;r++)n[r]=e.charCodeAt(r);return n}function n(n){var r,a,o=n.data,s=n.charset||"utf-8";return console.log(o,o instanceof Node),o instanceof Node?("svg"===o.tagName?(t(o),a="image/svg+xml"):"canvas"===o.tagName?(r=i(o),a="image/png"):a="text/html",r||(r=(new XMLSerializer).serializeToString(o))):o.length&&o[0]&&o[o.length-1]?(r=e(o),a="text/csv"):(r=JSON.stringify(o),a="text/json"),new Blob([r],{type:a+";charset="+s+";"})}return n}]),angular.module("vgraph").factory("svgColorize",[function(){"use strict";function t(t,e){Array.prototype.forEach.call(t,function(t){var i="";e.forEach(function(e){var n=document.defaultView.getComputedStyle(t,"").getPropertyValue(e);""!==n&&(i+=e+":"+n+";")}),t.setAttribute("style",i)})}function e(i){var n=e.settings;Object.keys(n).forEach(function(e){var r=i.getElementsByTagName(e);t(r,n[e])})}var i={path:["fill","stroke","stroke-width"],rect:["fill","stroke","opacity"],line:["stroke","stroke-width"],text:["text-anchor","font-size","color","font-family"],circle:["fill","stroke"]};return e.settings=i,e}]),angular.module("vgraph").factory("StatCalculations",[function(){"use strict";function t(t,e){var i=[];return t.forEach(function(t){i.push("$"+e+"$"+t.field)}),i}return{$resetCalcs:function(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].$reset()},$getFields:function(t){var e,i,n=[];for(e=0,i=t.length;i>e;e++)n.push(t[e].field);return n},$setFields:function(t,e){var i,n;for(i=0,n=t.length;n>i;i++)t[i].field=e[i]},getIndexs:function(t){var e,i={};return 1===t.length?e=t[0].$getIndexs():(e=[],t.forEach(function(t){e=e.concat(t.$getIndexs())}),e=e.filter(function(t){return i[t]?void 0:(i[t]=!0,t)})),e},stack:function(e){var i,n,r,a,o,s,c,h,l,u=t(e,"stack"),f=this.getIndexs(e);for(a=e.length,i=0,n=f.length;n>i;i++)for(s=0,c=f[i],r=0;a>r;r++)h=e[r],l=h.$getNode(c),o=h.getValue(l)||0,s+=o,l[u[r]]=s;for(r=0;a>r;r++)e[r].field=u[r];return u}}}]),angular.module("vgraph").factory("CalculationsCompile",[function(){"use strict";function t(t,e){return e?t?function(i){t(i),e(i)}:e:t}return function(e){var i,n,r,a,o;return e.forEach(function(e){angular.isFunction(e)?r=t(r,e):(n=t(n,e.prep),r=t(r,e.calc),a=t(a,e.reset),o=t(o,e.finalize))}),i=function(t){var e,i;if(r)for(e=0,i=t.length;i>e;e++)r(t[e]);o&&o(t.$stats)},i.$reset=function(t){a&&a(t.$stats)},i.$init=function(t){n&&n(t.$stats)},i}}]),angular.module("vgraph").factory("CalculationsExtremes",[function(){"use strict";function t(t){return function(e,i,n){var r,a;return{prep:function(){a=[]},reset:function(){a.forEach(function(t){t.node[n]=!1})},calc:function(n){var o=i(n);if(a.length<e)a.push({value:o,node:n}),a.length===e&&a.sort(function(t,e){return t.value-e.value});else if(t(o,a[0].value))if(a.shift(),t(a[0].value,o))a.unshift({value:o,node:n});else if(t(o,a[a.length-1].value))a.push({value:o,node:n});else for(r=a.length-2;r>=0;r--)t(o,a[r].value)&&(a.splice(r+1,0,{value:o,node:n}),r=0)},finalize:function(){a.forEach(function(t){t.node[n]=!0})}}}}return{maximum:t(function(t,e){return t>e}),minimum:t(function(t,e){return e>t})}}]),angular.module("vgraph").factory("CalculationsPercentiles",[function(){"use strict";return function(t,e,i){var n;return{prep:function(){n=[]},calc:function(t){n.push(e(t))},finalize:function(e){var r=Math.round(n.length*(t/100));n.sort(function(t,e){return t-e}),e[i]=n[r]}}}}]),angular.module("vgraph").factory("ComponentBox",["makeEventing",function(t){"use strict";function e(t,e){var i=e.padding,r=t.padding,a=e.margin,o=t.margin;o||(t.margin=o={top:0,right:0,bottom:0,left:0}),a&&(o.top=n(a.top,o.top),o.right=n(a.right,o.right),o.bottom=n(a.bottom,o.bottom),o.left=n(a.left,o.left)),r||(t.padding=r={top:0,right:0,bottom:0,left:0}),i&&(r.top=n(i.top,r.top),r.right=n(i.right,r.right),r.bottom=n(i.bottom,r.bottom),r.left=n(i.left,r.left)),t.outer||(t.outer={left:0,top:0}),t.outer.width=n(e.outer.width,t.outer.width)||0,t.outer.right=t.outer.width,t.outer.height=n(e.outer.height,t.outer.height)||0,t.outer.bottom=t.outer.height,t.top=o.top,t.bottom=t.outer.height-o.bottom,t.left=o.left,t.right=t.outer.width-o.right,t.width=t.right-t.left,t.height=t.bottom-t.top,t.center=(t.left+t.right)/2,t.middle=(t.top+t.bottom)/2,t.inner={top:t.top+r.top,bottom:t.bottom-r.bottom,left:t.left+r.left,right:t.right-r.right},t.inner.width=t.inner.right-t.inner.left,t.inner.height=t.inner.bottom-t.inner.top,t.ratio=t.outer.width+" x "+t.outer.height}function i(t){e(this,t||{outer:{}})}function n(t,e){return void 0!==t?parseInt(t):e}return t(i.prototype),i.prototype.targetSvg=function(t){this.$element=jQuery(t),this.resize()},i.prototype.resize=function(){var t=this.$element;t.attr("width",null).attr("height",null),t[0].style.cssText=null,e(this,{outer:{width:t.outerWidth(!0),height:t.outerHeight(!0)},margin:{top:t.css("margin-top"),right:t.css("margin-right"),bottom:t.css("margin-bottom"),left:t.css("margin-left")},padding:{top:t.css("padding-top"),right:t.css("padding-right"),bottom:t.css("padding-bottom"),left:t.css("padding-left")}}),t.css("margin","0").css("padding","0").attr("width",this.outer.width).attr("height",this.outer.height).css({width:this.outer.width+"px",height:this.outer.height+"px"}),this.inner.width&&this.inner.height&&this.$trigger("resize")},i}]),angular.module("vgraph").factory("ComponentChart",["$timeout","ComponentView","ComponentPage","ComponentBox","DataCollection","makeEventing","Scheduler","Hitbox","DomHelper",function(t,e,i,n,r,a,o,s,c){"use strict";function h(){var t=this;this.$vguid=++g,this.box=new n,this.views={},this.models=[],this.waiting={},this.references={},this.components=[],this.$on("focus",function(e){e?t.highlightOn(e):t.highlightOff()}),this.reset()}function l(t){var e,i;t.forEach(function(t){var n=t.viewport;(void 0===e||e>n.minValue)&&(e=n.minValue),(void 0===i||i<n.maxValue)&&(i=n.maxValue)}),t.forEach(function(t){t.setViewportValues(e,i)})}function u(t){var e,i;t.forEach(function(t){var n=t.viewport;(void 0===e||e>n.minInterval)&&(e=n.minInterval),(void 0===i||i<n.maxInterval)&&(i=n.maxInterval)}),t.forEach(function(t){t.setViewportIntervals(e,i)})}function f(t){for(var e=0,i=[];t>e;)i.push([]),e++;return i}function p(t){var e,i;for(e=0,i=t.length;i>e;e++)t[e].push(null)}var d=new o,g=1;a(h.prototype),h.defaultView="default",h.prototype.reset=function(){this.message="Configuring",this.loading=!0,this.pristine=!1,this.settings={}},h.prototype.configure=function(t,i){var n,r=this.addView.bind(this);this.reset(),i&&(this.settings.fitToPane=i.fitToPane,this.settings.adjustSettings=i.adjustSettings,this.page=t,this.zoom=t.getZoom(i.zoom),this.normalizeY=i.normalizeY,this.normalizeX=i.normalizeX,this.settings.x=e.parseSettingsX(i.x,this.settings.x),this.settings.y=e.parseSettingsY(i.y,this.settings.y),i.x?this.settings.x.scale=i.x.scale:this.settings.x.scale=null,i.y?this.settings.y.scale=i.y.scale:this.settings.y.scale=null,n=i.views,n?angular.isFunction(n)&&(n=n()):(n={},n[h.defaultView]={}),angular.forEach(n,r),i.onLoad&&i.onLoad(this),this.zoom.$on("update",this.rerender.bind(this)),this.message=null),this.$trigger("configured")};var m=0;return h.prototype.getReference=function(t){var e,i;return i=angular.isString(t)?t:t.name,e=this.references[i],e||(e={$uid:m++,name:i,className:t.className?t.className:"node-"+i},this.references[i]=e),e},h.prototype.compileReference=function(t){var e;if("object"!=typeof t)return null;if(e=this.getReference(t),void 0===t.field?e.field=e.name:e.field=t.field,t.pointAs&&(e.pointAs=t.pointAs),e._field=e.field,e.$reset=function(){e.field=e._field},void 0===t.getValue?e.getValue=function(t){return t?t[e.field]:void 0}:t.getValue&&(e.getValue=function(e){return t.getValue(e,this.$view.normalizer.$stats)}),void 0===t.view?t.view=h.defaultView:t.view&&(t.view=t.view),t.view)e.view=t.view,e.$view=this.getView(t.view),e.$getNode=function(t){return this.$view.normalizer.$getNode(t)},e.$getClosest=function(t){return this.$view.normalizer.$getClosest(t,"$x")},e.$getValue=function(t){var e=this.$view.normalizer.$getNode(t);return e?this.getValue(e):void 0},e.$eachNode=function(t){this.$view.normalizer.$sort().forEach(t)},e.$getIndexs=function(){return this.$view.normalizer.$getIndexs()};else if(t.$getValue)e.$getValue=t.$getValue;else if(!e.$getValue)throw new Error("drawer reference requires view or $getValue");return t.isValid&&(e.isValid=t.isValid),t.classExtend&&(e.classExtend=t.classExtend),t.requirements&&(e.requirements=t.requirements),t.normalizer&&(e.normalizer=t.normalizer),t.classify&&(e.classify=t.classify),t.mergePoint&&(e.mergePoint=t.mergePoint),e},h.prototype.render=function(){var t,e=this,i=[],n=!1,r=0;e.$trigger("render");try{angular.forEach(this.views,function(e,i){t=i,e.normalize()}),angular.forEach(this.components,function(t){t.parse&&t.parse()}),angular.forEach(this.views,function(e,i){t=i,e.parse()}),angular.forEach(this.views,function(e,r){t=r,e.hasData()?(i.push(e),n=!0):e.isReady()&&(n=!0)}),this.normalizeY&&l(i),this.normalizeX&&u(i)}catch(a){console.log("---parsing error---","view:"+t),console.log(a),console.log(a.stack)}r=i.length,this.loading=!n,d.startScript(this.$vguid),this.configureHitarea(),this.loading?(e.$trigger("loading"),d.func(function(){e.loading=!0,e.pristine=!1})):r?(d.func(function(){e.message=null}),d.loop(this.components,function(t){t.build&&t.build()}),d.loop(i,function(t){t.build()}),d.loop(this.components,function(t){t.process&&t.process()}),d.loop(i,function(t){t.process()}),d.loop(this.components,function(t){t.finalize&&t.finalize()}),d.loop(i,function(t){t.finalize(),e.$trigger("publish:"+t.$name,t.normalizer)}),d.func(function(){e.loading=!1,e.pristine=!0})):(e.$trigger("error"),d.func(function(){e.message="No Data Available",e.pristine=!1})),d.endScript(function(){e.rendered=!0,e.$trigger("rendered")},function(){e.$trigger("success",i[0])},function(){e.pristine=!1,e.message="Unable to Render",e.$trigger("error")}),d.run()},h.prototype.scheduleRender=function(e){var i=this;this.nrTimeout||(this.nrTimeout=t(function(){i.render(i.waiting,e),i.waiting={},i.nrTimeout=null},30))},h.prototype.rerender=function(t){this.rendered&&(this.scheduleRender(t),this.waiting=this.views)},h.prototype.needsRender=function(t,e){this.scheduleRender(e),this.waiting[t.name]||(this.waiting[t.name]=t)},h.prototype.getView=function(t){var i=this.views[t];return i||(i=new e,this.views[t]=i),i},h.prototype.addView=function(t,e){var i=this,n=this.settings,r=this.getView(e);r.configure(t,n,this.box,this.page,this.zoom),r.$name=e,r.manager.register(function(){i.needsRender(r)}),r.manager.onError(function(t){i.error(t)})},h.prototype.error=function(t){t?(this.loading=!1,this.message=t):this.message=null,this.$trigger("error")},h.prototype.registerComponent=function(t){this.components.push(t)},h.prototype.configureHitarea=function(){var t=this.box;this.hitbox=new s(t.left,t.right,t.top,t.bottom,10)},h.prototype.addHitbox=function(t,e){t.$element=e,this.hitbox.add(t)},h.prototype.highlightElements=function(t,e){var i=this.hitbox.checkX(t),n=this.hitbox.checkY(e),r=this.hitbox.checkHit(t,e);this.unlightElements(),c.addClass(i,"highlight-vertical").bringForward(i),c.addClass(n,"highlight-horizontal"),c.addClass(r,"highlight"),this.$trigger("publish:focus",r),this._activeElements={vertical:i,horizontal:n,intersections:r}},h.prototype.unlightElements=function(){var t=this._activeElements;t&&(c.removeClass(t.vertical,"highlight-vertical"),c.removeClass(t.horizontal,"highlight-horizontal"),c.removeClass(t.intersections,"highlight"))},h.prototype.highlightOn=function(t){var e=0,i=0,n={},r=this.references;angular.forEach(this.views,function(r,a){var o,s;r.components.length&&(o=r.getPoint(t.x),o&&(n[a]=o,s=o.$x,void 0!==s&&(i++,e+=s)))}),n.$pos=e/i,n.pos=t,Object.keys(this.references).forEach(function(e){var i=r[e];i.pointAs&&(n[i.view][i.pointAs]=i.getValue(i.$getClosest(t.x)))}),this.$trigger("focus-point",n),this.$trigger("highlight",n),this.highlightElements(t.x,t.y)},h.prototype.highlightOff=function(){this.$trigger("publish:focus",null),this.$trigger("highlight",null),this.unlightElements()},h.prototype["export"]=function(t){var e,i,n,r=t.map(function(t){return t.title}),a=this.getReference.bind(this);return t.forEach(function(t){var i;t.$link=a(t.reference),t.$view=t.$link.$view,i=t.$view.getBounds(),t.$bounds=i,e?(e<i.max-i.min&&(e=i.max-i.min),n>i.interval&&(n=i.interval)):(e=i.max-i.min,n=i.interval)}),i=f(Math.ceil(e/n)),t.forEach(function(t){var n,r,a,o=t.$bounds.min,s=o+e,c=t.$bounds.interval;for(a=i[0].length,p(i),n=o;s>=n;n+=c)r=t.$view.manager.data.$getNode(n),r&&(r=r[t.field?t.field:t.reference],t.format&&(r=t.format(r)),i[Math.floor((n-o)/(s-o)*e+.5)][a]=r)}),i.unshift(r),i},h}]),angular.module("vgraph").factory("ComponentElement",["StatCalculations",function(t){"use strict";function e(t){return(new DOMParser).parseFromString('<g xmlns="http://www.w3.org/2000/svg">'+t+"</g>","image/svg+xml").childNodes[0].childNodes}function i(t,e,i){var n,r,a,o=t.element;for(o.innerHTML="",n=i.length-1;-1!==n;n--)a=e[n],r=i[n],t.drawer.getHitbox&&t.chart.addHitbox(t.drawer.getHitbox(a),r),o.appendChild(r),t.onAppend&&t.onAppend(r,a)}function n(){this.children=null}function r(t,e){var i,n,r,a=[];for(i=0,n=t.length;n>i;i++)r=e(t[i]),r&&a.push(r);return a}return n.svgCompile=e,n.prototype.setChart=function(t,e){this.chart=t,this.publish=e},n.prototype.setElement=function(t){this.element=t},n.prototype.setDrawer=function(t){var e=[],i=t.getReferences();this.drawer=t,i.forEach(function(t){t&&e.push(t)}),this.references=e},n.prototype.parse=function(){var e=this.drawer;return e.parse(t.getIndexs(this.references)),e.getLimits()},n.prototype.build=function(){var t=this.drawer,n=t.dataSets;this.publish&&this.chart.$trigger("publish:"+this.publish,n),n.forEach(function(e){t.closeSet(e)}),"g"===this.element.tagName?i(this,n,e(r(n,t.makeElement.bind(t)).join(""))):this.element.setAttribute("d",r(n,t.makePath.bind(t)).join(""))},n.prototype.register=function(){},n}]),angular.module("vgraph").factory("ComponentPage",["DataFeed","DataLoader","DataManager","ComponentZoom",function(t,e,i,n){"use strict";function r(){this.$$pageUid=a++,this.charts={},this.zooms={}}var a=1;return r.defaultManager="default",r.defaultZoom="default",r.prototype.reset=function(){var t=this.zooms,e=this.feed,i=this.loaders,n=this.managers;Object.keys(t).forEach(function(e){t[e].reset()}),i&&Object.keys(i).forEach(function(t){var e=i[t];Object.keys(e).forEach(function(t){e[t].$destroy()})}),this.loaders={},e&&Object.keys(e).forEach(function(t){e[t].$destroy()}),this.feeds={},n&&Object.keys(n).forEach(function(t){n[t].$destroy()}),this.managers={}},r.prototype.configure=function(t){var e,i,n,r,a,o;if(this.reset(),t)if(angular.isArray(t))for(e=0,i=t.length;i>e;e++)this.addFeed(t[e]);else{if(t.managers)for(r=Object.keys(t.managers),e=0,i=r.length;i>e;e++)n=r[e],a=t.managers[n],o=this.getManager(n),a.fill&&o.fillPoints(a.fill),a.calculations&&o.setCalculations(a.calculations);if(t.feeds)for(e=0,i=t.feeds.length;i>e;e++)this.addFeed(t.feeds[e])}},r.prototype.addFeed=function(i){var n,a,o,s,c=i.src;return i.manager||(i.manager=r.defaultManager),s=i.manager,c._$feedUid&&this.feeds[c._$feedUid]?n=this.feeds[c._$feedUid]:(n=c instanceof t?c:new t(c,i.explode),this.feeds[n.$$feedUid]=n,c._$feedUid=n.$$feedUid),o=this.getManager(s),this.loaders[n.$$feedUid]||(this.loaders[n.$$feedUid]={}),a=this.loaders[n.$$feedUid][o.$$managerUid],a||(a=new e(n,o),this.loaders[n.$$feedUid][o.$$managerUid]=a),a.addConfig(i),c},r.prototype.getManager=function(t){var e=t||r.defaultManager,n=this.managers[e];return n||(n=new i,this.managers[e]=n),n},r.prototype.setChart=function(t,e){this.charts[t]=e},r.prototype.getChart=function(t){return this.charts[t]},r.prototype.getZoom=function(t){var e=t||r.defaultManager,i=this.zooms[e];return i||(i=new n,this.zooms[e]=i),i},r}]),angular.module("vgraph").factory("ComponentPane",["DataList",function(t){"use strict";function e(e,i,n){this.x=i,this.y=n,e===!0?this.fitToPane=!0:e&&(this.snapTo=new t(function(t){return t}),this.snapTo.absorb(e)),this._pane={},this._bounds={},i||(i={}),n||(n={}),this.setBounds({min:i.min,max:i.max},{min:n.min,max:n.max})}return e.prototype.setBounds=function(t,e){return this._bounds.x=t,this._bounds.y=e,this},e.prototype.setPane=function(t,e){return this._pane.x=t,this._pane.y=e,this},e.prototype.filter=function(t,e){var i,n,r,a,o,s,c=this.x,h=t.data;return h.length&&(t.clean(),i=void 0!==this._bounds.x.min?this._bounds.x.min:h.$minIndex,n=void 0!==this._bounds.x.max?this._bounds.x.max:h.$maxIndex,c.$min=i,c.$max=n,this._pane.x&&this._pane.x.max?(r=this._pane.x,o=i+r.min*(n-i),s=i+r.max*(n-i),this.snapTo&&(o=this.snapTo.closest(o),s=this.snapTo.closest(s))):(o=i,s=n),e.$left=o,e.left=(o-i)/(n-i),e.$right=s,e.right=(s-i)/(n-i),a=h.$slice(o,s),this.fitToPane&&h.length>1&&(o>h.$minIndex&&a.$add(o,t.$makePoint(o),!0),s<h.$maxIndex&&a.$add(s,t.$makePoint(s))),a.$sort()),a},e}]),angular.module("vgraph").factory("ComponentView",["ComponentPane","DataNormalizer","CalculationsCompile",function(t,e,i){"use strict";function n(){this.$vgvid=o++,this.components=[],this.references=[]}function r(t,e){return e||(e={}),void 0!==t.min&&(e.min=t.min),void 0!==t.max&&(e.max=t.max),t.scale?e.scale=t.scale():e.scale||(e.scale=d3.scale.linear()),t.format?e.format=t.format:e.scale||(e.format=function(t){return t}),t.padding&&(e.padding=t.padding),t.tick&&(e.tick=t.tick),e}function a(t,e){t.requirements?t.requirements.forEach(function(t){e.addPropertyCopy(t)}):null!==t.requirements&&e.addPropertyCopy(t.field),t.normalizer&&(t.normalizer.map&&e.addPropertyMap(t.normalizer.map),t.normalizer.finalize&&e.addPropertyFinalize(t.normalizer.finalize))}var o=1;return n.parseSettingsX=function(t,e){return t||(t={}),e=r(t,e),void 0!==t.minPane&&(e.minPane=t.minPane),void 0!==t.maxPane&&(e.maxPane=t.maxPane),void 0!==t.interval&&(e.interval=t.interval),e},n.parseSettingsY=function(t,e){return t||(t={}),r(t,e)},n.prototype.getBounds=function(){var t,e,i,n,r,a,o=this.manager.data;if(o.$sort(),this.x.interval)a=this.x.interval;else for(r=o[1]._$index,a=r-o[0]._$index,t=2,e=o.length;e>t;t++)i=o[t]._$index,n=i-r,a>n&&(a=n),r=i;return{min:void 0!==this.x.min?this.x.min:o[0]._$index,max:void 0!==this.x.max?this.x.max:o[o.length-1]._$index,interval:a}},n.prototype.configure=function(r,o,s,c,h){var l,u=this.references,f=Object.keys(this.references);this.x=n.parseSettingsX(o.x,this.x),n.parseSettingsX(r.x,this.x),this.y=n.parseSettingsY(o.y,this.y),n.parseSettingsY(r.y,this.y),this.box=s,this.manager=c.getManager(r.manager),this.normalizer=l=r.normalizer||new e(function(t){return Math.round(t)}),r.calculations&&(this.calculations=i(r.calculations)),f.forEach(function(t){a(u[t],l)}),this.adjustSettings=r.adjustSettings||o.adjustSettings,this.pane=new t(r.fitToPane||o.fitToPane,this.x,this.y),this.x.max&&this.pane.setBounds({min:this.x.min,max:this.x.max}),this.pane.setPane({min:h.left,max:h.right}),h.$on("update",this.pane.setPane.bind(this.pane))},n.prototype.registerComponent=function(t){var e=this.normalizer,i=this.references;this.components.push(t),t.references&&t.references.forEach(function(t){i[t.name]||(i[t.name]=t,e&&a(t,e))})},n.prototype.isReady=function(){return this.manager&&this.manager.ready},n.prototype.hasData=function(){return this.isReady()&&this.manager.data.length},n.prototype._sample=function(){this.offset={},this.filtered=this.pane.filter(this.manager,this.offset)},n.prototype.isLeading=function(){return this.viewport&&this.viewport.maxInterval>this.filtered.$maxIndex},n.prototype.getLeading=function(){return this.normalizer[this.normalizer.length-1]},n.prototype.setViewportValues=function(t,e){var i,n=this.box;this.y.padding&&(i=e===t?t*this.y.padding:(e-t)*this.y.padding,e+=i,t-=i),this.viewport.minValue=t,this.viewport.maxValue=e,this.y.scale.domain([t,e]).range([n.inner.bottom,n.inner.top])},n.prototype.setViewportIntervals=function(t,e){var i=this.box,n=this.x.scale;this.viewport.minInterval=t,this.viewport.maxInterval=e,n.domain([t,e]).range([i.inner.left,i.inner.right])},n.prototype.normalize=function(){this.manager&&(this._sample(),this.filtered&&(this.viewport||(this.viewport={}),this.setViewportIntervals(this.offset.$left,this.offset.$right),this.normalizer.$reindex(this.filtered,this.x.scale),this.calculations&&(this.calculations.$init(this.normalizer),this.calculations(this.normalizer))))},n.prototype.parse=function(){var t,e;this.normalizer&&this.normalizer.length&&(this.components.forEach(function(i){var n;i.parse&&(n=i.parse(),n&&((n.min||0===n.min)&&(!t&&0!==t||t>n.min)&&(t=n.min),(n.max||0===n.max)&&(!e&&0!==e||e<n.max)&&(e=n.max)))}),void 0!==t&&(this.setViewportValues(t,e),this.adjustSettings&&this.adjustSettings(this.x,this.filtered.$maxIndex-this.filtered.$minIndex,this.y,e-t)))},n.prototype.build=function(){this.components.forEach(function(t){t.build&&t.build()})},n.prototype.process=function(){this.components.forEach(function(t){t.process&&t.process()})},n.prototype.finalize=function(){this.components.forEach(function(t){t.finalize&&t.finalize()})},n.prototype.getPoint=function(t){return this.normalizer?this.normalizer.$getClosest(t,"$x"):void console.log("unconfigured",this)},n}]),angular.module("vgraph").factory("ComponentZoom",["makeEventing",function(t){"use strict";function e(){this.reset()}return t(e.prototype),e.prototype.setRatio=function(t,e,i,n){t>e?(this.left=e,this.right=t):(this.left=t,this.right=e),n&&(i>n?(this.top=i,this.bottom=n):(this.top=n,this.bottom=i)),this.$trigger("update",{min:this.left,max:this.right},{min:this.bottom,max:this.top})},e.prototype.reset=function(){this.left=0,this.right=1,this.bottom=0,this.top=1},e}]),angular.module("vgraph").factory("DataBucketer",[function(){"use strict";function t(t,e){this._hasher=t,this._factory=e||function(){return[]},this.$reset()}return t.prototype=[],t.prototype.push=function(t){var e=this._insert(t);e&&Array.prototype.push.call(this,e)},t.prototype.unshift=function(t){var e=this._insert(t);e&&Array.prototype.unshift.call(this,e)},t.prototype._insert=function(t){var e=!1,i=this._hasher(t),n=this._$index[i];return n?void n.push(t):(e=!0,n=this._factory(i),this._$index[i]=n,this._$indexs.push(i),n.push(t),n)},t.prototype.$reset=function(){this.length=0,this._$index={},this._$indexs=[]},t.prototype.$getIndexs=function(){return this._$indexs},t.prototype.$getBucket=function(t){return this._$index[t]},t}]),angular.module("vgraph").factory("DataCollection",["DataList",function(t){"use strict";function e(t){return null!==t&&void 0!==t&&"object"!=typeof t}function i(){this.$getValue=function(t){return t._$index},this.$reset()}function n(t){return t||0===t}return i.prototype=new t,i.isNumeric=e,i.isValid=n,i.prototype.$reset=function(){this.length=0,this.$dirty=!1,this.$stats={},this._$index={},this._$indexs=[]},i.prototype.addPropertyCopy=function(t){var e,i;this._copyProperties?(e=this._copyProperties,this._copyProperties=function(i,n){n[t]=i[t],e(i,n)},i=this._hasValue,this._hasValue=function(e){return n(e[t])?!0:i(e)}):(this._copyProperties=function(e,i){i[t]=e[t]},this._hasValue=function(e){return n(e[t])})},i.prototype.addPropertyMap=function(t){var e;this._mapProperties?(e=this._mapProperties,this._mapProperties=function(i,n){e(i,n),t(i,n)}):this._mapProperties=t},i.prototype.$add=function(t,e,i){var n=+t;return this._$index[n]||(this._$indexs.push(n),this._$index[n]=e,i?(this.length&&n>this[0]._$index&&(this.$dirty=!0),this.unshift(e)):(this.length&&n<this[this.length-1]._$index&&(this.$dirty=!0),this.push(e)),(!this._hasValue||this._hasValue(e))&&(void 0===this.$minIndex?(this.$minIndex=n,this.$maxIndex=n):this.$maxIndex<n?this.$maxIndex=n:this.$minIndex>n&&(this.$minIndex=n)),e._$index=n),e},i.prototype._makeNode=function(t){var e=+t,i=this.$getNode(t);if(isNaN(e))throw new Error("index must be a number, not: "+t+" that becomes "+e);return i||(i={},this.$add(e,i)),i},i.prototype.$getIndexs=function(){return this._$indexs},i.prototype.$getNode=function(t){return this._$index[t]},i.prototype._setValue=function(t,e,i){var r=t._$index;t.$setValue?t.$setValue(e,i):t[e]=i,n(i)&&(void 0===this.$minIndex?(this.$minIndex=r,this.$maxIndex=r):this.$maxIndex<r?this.$maxIndex=r:this.$minIndex>r&&(this.$minIndex=r))},i.prototype.$setValue=function(t,e,i){var n=this._makeNode(t);return this._setValue(n,e,i),n},i.prototype.$addNode=function(t,e,i){var n,r=+t;return n=this.$getNode(r),n?(n.$merge&&n.$merge(e),this._mapProperties&&this._mapProperties(e,n,r),this._copyProperties&&this._copyProperties(e,n,r)):(n=this.$makeNode?this.$makeNode(e):{},this._mapProperties&&this._mapProperties(e,n,r),this._copyProperties&&this._copyProperties(e,n,r),this.$add(r,n,i)),n},i.prototype.$getClosest=function(t,e){return e||(e="_$index"),this.closest(t,function(t){return t[e]})},i.prototype.$slice=function(t,e){var n,r=-1,a=new i;this.$sort();do r++,n=this[r];while(n&&n._$index<t);for(;n&&n._$index<=e;)a.push(n),a._$index[n._$index]=n,a._$indexs.push(n._$index),r++,n=this[r];return a.$minIndex=a[0]._$index,a.$maxIndex=a[a.length-1]._$index,a.$dirty=!1,a.$stats=Object.create(this.$stats),a.$parent=this,a},i}]),angular.module("vgraph").factory("DataFeed",["makeEventing",function(t){"use strict";function e(t,e){this.explode=e,this.setSource(t),this.$$feedUid=i++}var i=1;return e.prototype.setSource=function(t){var e=this,i=t||[],n=i.push;this.data=i,this._readPos=0,i.push=function(){n.apply(this,arguments),e.$onPush()},i.$ready=function(){e.$trigger("ready")},i.$error=function(t){e.$trigger("error",t)},i.$reset=function(){e.$trigger("reset"),e._readPos=0,i.length=0},this.$onPush(),this.$destroy=function(){delete e.data,t.push=n}},t(e.prototype),e.prototype.consume=function(t){var e,i;for(e=0,i=t.length;i>e;e++)this.data.push(t[e])},e.prototype.$onPush=function(){var t=this;this._$onPush||(this._$onPush=setTimeout(function(){var e=t._readNext();for(e&&t.$trigger("ready");e;)t.$trigger("data",e),e=t._readNext();t._$onPush=null},5))},e.prototype._readAll=function(t){for(var e=this._read(0);e;)t(e),e=this._read(e.next)},e.prototype._readNext=function(){var t=this._read(this._readPos);return t&&(this._readPos=t.next),t},e.prototype._read=function(t){var e,i=this.data,n=this.explode;return!i.length||t>=i.length?null:n?(e=i[t],{points:n(e),next:t+1,ref:e}):{points:i.slice(t),next:i.length}},e}]),angular.module("vgraph").factory("DataHasher",[function(){"use strict";function t(t,e){return t?function(i){return e>i?e:t(i)}:function(){return e}}return{bucketize:function(e){var i,n;for(i=e.length-1;i>-1;i--)n=t(n,e[i]);return n}}}]),angular.module("vgraph").factory("DataList",[function(){"use strict";function t(t,e,i){var n,r,a=0,o=t.length-1;if(i(t[a])>=e)return{left:a,right:a};if(i(t[o])<=e)return{left:o,right:o};if(t.length){for(;o-a>1;)n=Math.floor((o+a)/2),r=i(t[n]),r===e?(o=n,a=n):r>e?o=n:a=n;return o!==n&&i(t[o])===e?{left:o,right:o}:a!==n&&i(t[a])===e?{left:a,right:a}:{left:a,right:o}}}function e(t){this.$reset(),this.$getValue=t}e.prototype=[],e.prototype.bisect=function(e,i){return this.$sort(),t(this,e,i)},e.prototype.closestPair=function(t,e){var i=this.bisect(t,e||this.$getValue);return{left:this[i.left],right:this[i.right]}},e.prototype.closest=function(t,e){var i,n,r=e||this.$getValue,a=this.closestPair(t,r);return i=t-r(a.left),n=r(a.right)-t,n>i?a.left:a.right},e.prototype.$reset=function(){this.length=0,this.$dirty=!1};var i=Array.prototype.sort;e.prototype.sort=function(t){this.$dirty=!0,i.call(this,t)},
e.prototype.$sort=function(){var t=this.$getValue;return this.$dirty&&(this.sort(function(e,i){return t(e)-t(i)}),this.$dirty=!1),this};var n=Array.prototype.push;return e.prototype.absorb=function(t){this.$dirty=!0,n.apply(this,t)},e}]),angular.module("vgraph").factory("DataLoader",[function(){"use strict";function t(t,e){var i=this,r=[],a=this._process.bind(this),o=t.$on("ready",function(){i.ready=!0}),s=t.$on("data",function(t){var e,i,n,o;for(e=0,i=t.points.length;i>e;e++)for(n=0,o=r.length;o>n;n++)a(r[n],t.points[e])}),c=t.$on("error",function(t){e.setError(t)}),h=t.$on("reset",function(){e.reset(),i.ready=!1});this.$$loaderUid=n++,this.feed=t,this.confs=r,this.dataManager=e,e.$follow(this),this.$destroy=function(){e.$ignore(this),c(),h(),o(),s()}}function e(t,e){return e?function(i){try{return e(i[t])}catch(n){return void 0}}:function(e){try{return e[t]}catch(i){return void 0}}}function i(t){var i,n,r=t.split(".");for(i=r.length-1;i>-1;i--)n=e(r[i],n);return n}var n=1;return t.prototype.addConfig=function(t){var e,n,r=this._process.bind(this);Object.keys(t.readings).forEach(function(e){var r=n,a=i(e),o=t.readings[e];n=r?function(t,e,i){var n=a(e);void 0!==n&&i.setValue(t,o,n),r(t,e,i)}:function(t,e,i){var n=a(e);void 0!==n&&i.setValue(t,o,n)}}),e={reader:n},t.parseInterval?e.parseInterval=t.parseInterval:e.parseInterval=function(e){return+e[t.interval]},t.massage&&(e._parseInterval=e.parseInterval,e.massage=t.massage,e.parseInterval=function(t){return this.massage(this._parseInterval(t))}),this.feed._readAll(function(t){var i,n,a=t.points;for(i=0,n=a.length;n>i;i++)r(e,a[i])}),this.confs.push(e)},t.prototype.removeConf=function(){},t.prototype._process=function(t,e){var i;if(!t.isDefined||t.isDefined(e))try{i=t.parseInterval(e),t.reader(i,e,this.dataManager)}catch(n){console.log("failed to load",e,i),console.log("conf:",t),console.log(n)}},t}]),angular.module("vgraph").factory("DataManager",["DataCollection","CalculationsCompile",function(t,e){"use strict";function i(){var t=[];this.registrations=[],this.errorRegistrations=[],this.$$managerUid=r++,this.$dataProc=n(20,200,function(t){t.calculations&&(t.calculations.$reset(t.data),t.calculations(t.data)),t.registrations.forEach(function(t){t()})}),this.getLoaders=function(){return t},this.$follow=function(e){t.push(e)},this.$ignore=function(e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)},this.reset()}function n(t,e,i,n){function r(){var e=+new Date;e>s||e>o?(s=null,i.apply(n,a)):setTimeout(r,t)}var a,o,s;return function(){var i=+new Date;o=i+t,a=arguments,s||(s=i+e,setTimeout(r,t))}}var r=1;return i.prototype.$destroy=function(){this.reset()},i.prototype.reset=function(){this.data=new t,this.ready=!1,this.dataReady(!0)},i.prototype.fillPoints=function(t){var e,i,n=t.prototype;for(this.filling=t,n||(n={}),e=t.start,i=t.stop+t.interval;i>e;e+=t.interval)this.data.$add(e,Object.create(n))},i.prototype.setCalculations=function(t){this.calculations=e(t),this.calculations.$init(t)},i.prototype.setValue=function(t,e,i){return this.filling&&(t<this.filling.min||t>this.filling.max||(t-this.filling.min)%this.filling.interval!==0)?void 0:(this.dataReady(),this.ready||!i&&0!==i||(this.ready=!0),this.data.$setValue(t,e,i))},i.prototype.dataReady=function(t){var e=this.registrations;t?e.forEach(function(t){t()}):this.$dataProc(this)},i.prototype.onError=function(t){this.errorRegistrations.push(t)},i.prototype.setError=function(t){var e,i;for(e=0,i=this.errorRegistrations.length;i>e;e++)this.errorRegistrations[e](t)},i.prototype.getNode=function(t){return this.dataReady(),this.data.$getNode(t)},i.prototype.removePlot=function(){},i.prototype.register=function(t){this.registrations.push(t)},i.prototype.clean=function(){this.data.$sort()},i.prototype.$makePoint=function(t){var e,i,n,r,a=this.data.closestPair(t);return a.right===a.left?a.right:(e=a.right,i=a.left,n={},r=(t-i._$index)/(e._$index-i._$index),Object.keys(e).forEach(function(t){var a=i[t],o=e[t];void 0!==a&&null!==a&&void 0!==o&&null!==o&&(n[t]=a+(o-a)*r)}),n.$faux=!0,n._$index=t,n)},i}]),angular.module("vgraph").factory("DataNormalizer",["DataCollection",function(t){"use strict";function e(e){this.$modelUid=i++,this.$grouper=e,t.call(this),this._finalizeProperties=function(t){t.$x=t.$x/t.$count}}var i=1;return e.prototype=new t,e.prototype.addPropertyFinalize=function(t){var e=this._finalizeProperties;this._finalizeProperties=function(i){e(i),t(i)}},e.prototype.$latestNode=function(e){for(var i,n=this.length-1;n;){if(i=this[n],t.isValid(i[e]))return i;n--}},e.prototype.$reindex=function(t,e){var i,n,r,a,o,s,c,h=this.$grouper;for(this.$reset(),t.$sort(),i=0,n=t.length;n>i;i++)o=t[i],s=o._$index,c=e(o._$index),a=h(c,s),void 0!==a&&(r=this.$addNode(a,o),void 0===r.$minIndex?(r.$x=c,r.$minIndex=s,r.$xMin=c,r.$maxIndex=s,r.$xMax=c,r.$count=1):(r.$x+=c,r.$maxIndex=s,r.$xMax=c,r.$count++));for(i=0,n=this.length;n>i;i++)o=this[i],o.$avgIndex=(o.$minIndex+o.$maxIndex)/2,this._finalizeProperties(o);this.$stats=Object.create(t.$stats),this.$parent=t},e}]),angular.module("vgraph").factory("DrawBar",["DrawLinear",function(t){"use strict";function e(t,e,i){this.width=i,this.top=t,e?(this.bottom=e,this.references=[t,e]):(this.bottom=t,this.references=[t])}function i(t,e,i,n,r){var a;return t>e&&(a=t,t=e,e=a),"+"!==i&&"-"!==n&&n>i&&(a=i,i=n,n=a),void 0===r.x1?(r.x1=t,r.x2=e,r.y1=i,r.y2=n):(r.x1>t&&(r.x1=t),e>r.x2&&(r.x2=e),"+"!==r.y1&&("+"===i||r.y1<i)&&(r.y1=i),"-"!==r.y2&&("-"===n||r.y2>n)&&(r.y2=n)),r}var n=t.isNumeric;return e.prototype=new t,e.prototype.makeSet=function(){return{}},e.prototype.isValidSet=function(t){return void 0!==t.x1},e.prototype.getPoint=function(t){var e,i,r,a,o,s,c=this.top.$getNode(t);return r=this.top.getValue(c),a=this.bottom!==this.top?this.bottom.$getValue(t):"-",s=this.width?parseInt(this.width,10)/2:3,n(r)&&n(a)&&r!==a&&(e=c.$x-s,i=c.$x+s,o={$classify:this.top.classify?this.top.classify(c,this.bottom.$getNode(t)):null,x1:e<c.$xMin?e:c.$xMin,x2:i>c.$xMax?c.$xMax:i,y1:r,y2:a}),o},e.prototype.mergePoint=function(t,e){var n=t.x1,r=t.x2,a=t.y1,o=t.y2;return null!==a&&null!==o&&(void 0===a&&(a=e.y1),void 0===o&&(o=e.y2),i(n,r,a,o,e)),0},e.prototype.closeSet=function(t){var e=this.top.$view,i=this.bottom.$view,n="+"===t.y1?e.viewport.maxValue:t.y1,r="-"===t.y2?i.viewport.minValue:t.y2;t.y1=e.y.scale(n),t.y2=i.y.scale(r)},e.prototype.makePath=function(t){return t?"M"+(t.x1+","+t.y1)+"L"+(t.x2+","+t.y1)+"L"+(t.x2+","+t.y2)+"L"+(t.x1+","+t.y2)+"Z":void 0},e.prototype.makeElement=function(t){var e="";return t?(t.$classify&&(e=Object.keys(t.$classify).join(" ")),'<rect class="'+e+'" x="'+t.x1+'" y="'+t.y1+'" width="'+(t.x2-t.x1)+'" height="'+(t.y2-t.y1)+'"/>'):void 0},e.prototype.getHitbox=function(t){return t},e}]),angular.module("vgraph").factory("DrawBox",["DrawBar",function(t){"use strict";function e(t){this.top=t,this.bottom=t,this.references=[t]}return e.prototype=new t,e.prototype.getPoint=function(t){var e,i,n=this.top.$getNode(t);return this.top.isValid(n)?(this.top.getValue?(i=this.top.getValue(n),e={x1:n.$x,x2:n.$x,y1:i,y2:i}):e={x1:n.$x,x2:n.$x,y1:"+",y2:"-"},e.$classify=this.top.classify?this.top.classify(n):null,e):void 0},e.prototype.mergePoint=function(e,i){return!e.y1&&0!==e.y1||!e.y2&&0!==e.y2?0:(t.prototype.mergePoint.call(this,e,i),-1)},e}]),angular.module("vgraph").factory("DrawCandlestick",["DrawLinear",function(t){"use strict";function e(t){this.ref=t,this.references=[t],t.normalizer={map:function(e,i){var n=t.field,r="$min"+n,a="$max"+n,o="$"+n,s=e[n];i[o]?(i[o]+=s,i.$track.push(s)):(i[o]=s,i.$track=[s]),void 0===i[r]?(i[r]=s,i[a]=s):i[r]>s?i[r]=s:i[a]<s&&(i[a]=s)},finalize:function(e){var i="$"+t.field;e[i]=e[i]/e.$count}}}return e.prototype=new t,e.prototype.makeSet=function(){return{}},e.prototype.getPoint=function(t){var e=this.ref,i=e.$getNode(t);return{$classify:this.ref.classify?this.ref.classify(i):null,x:i.$x,y:i["$"+e.field],min:i["$min"+e.field],max:i["$max"+e.field]}},e.prototype.mergePoint=function(t,e){return e.x=t.x,e.y=t.y,e.min=t.min,e.max=t.max,0},e.prototype.getLimits=function(){var t,e;return this.dataSets.forEach(function(i){i.x&&(void 0===t?(t=i.min,e=i.max):(i.min<t&&(t=i.min),i.max>e&&(e=i.max)))}),{min:t,max:e}},e.prototype.closeSet=function(t){var e=this.ref.$view.y.scale;t.y=e(t.y),t.min=e(t.min),t.max=e(t.max)},e.prototype.makePath=function(t){return t.x?"M"+t.x+","+t.max+"L"+t.x+","+t.min+"M"+(t.x-2)+","+t.y+"L"+(t.x+2)+","+t.y:void 0},e.prototype.makeElement=function(t){var e="";return t.x?(t.$classify&&(e=Object.keys(t.$classify).join(" ")),'<path class="'+e+'" d="'+this.makePath(t)+'"></path>'):void 0},e.prototype.getHitbox=function(t){return t.x1=t.x-2,t.x2=t.x+2,t.y1=t.max,t.y2=t.min,t},e}]),angular.module("vgraph").factory("DrawDots",["DrawLinear",function(t){"use strict";function e(t,e){this.ref=t,this.radius=e,this.references=[t]}return e.prototype=new t,e.prototype.makeSet=function(){return{}},e.prototype.getPoint=function(t){var e=this.ref.$getNode(t),i=this.ref.getValue(e);return i||0===i?{$classify:this.ref.classify?this.ref.classify(e):null,x:e.$x,y:i}:void 0},e.prototype.mergePoint=function(t,e){return e.x=t.x,e.y=t.y,0},e.prototype.closeSet=function(t){t.y=this.ref.$view.y.scale(t.y)},e.prototype.makePath=function(t){var e=this.radius,i=2*e;return void 0!==t.x?"M"+t.x+" "+t.y+"m -"+e+", 0a "+e+","+e+" 0 1,1 "+i+",0a "+e+","+e+" 0 1,1 -"+i+",0":void 0},e.prototype.makeElement=function(t){var e="";return void 0!==t.x?(t.$classify&&(e=Object.keys(t.$classify).join(" ")),'<circle class="'+e+'" cx="'+t.x+'" cy="'+t.y+'" r="'+this.radius+'"/>'):void 0},e.prototype.getHitbox=function(t){var e=this.radius;return{x1:t.x-e,x2:t.x+e,y1:t.y-e,y2:t.y+e,intersect:function(i,n){return Math.sqrt(Math.pow(t.x-i,2)+Math.pow(t.y-n,2))<=e}}},e}]),angular.module("vgraph").factory("DrawFill",["DrawLinear",function(t){"use strict";function e(t,e){this.top=t,e?(this.bottom=e,this.references=[t,e]):(this.bottom=t,this.references=[t])}var i=t.isNumeric;return e.prototype=new t,e.prototype.getPoint=function(t){var e,n,r=this.top.$getNode(t);return e=this.top.getValue(r),n=2===this.references.length?this.bottom.$getValue(t):"-",i(e)&&i(n)?{$classify:this.top.classify?this.top.classify(r,this.bottom.$getNode(t)):null,x:r.$x,y1:e,y2:n}:void 0},e.prototype.mergePoint=function(t,e){var n=t.x,r=t.y1,a=t.y2,o=e[e.length-1];return i(r)&&i(a)?(e.push({x:n,y1:r,y2:a}),-1):o&&null!==r&&null!==a?(void 0===r&&(r=o.y1),void 0===a&&o&&(a=o.y2),e.push({x:n,y1:r,y2:a}),-1):0},e.prototype.makePath=function(t){var e,i,n,r,a,o=this.top.$view,s=this.bottom.$view,c=[],h=[];if(t.length){for(e=0,i=t.length;i>e;e++)a=t[e],n="+"===a.y1?o.viewport.maxValue:a.y1,r="-"===a.y2?s.viewport.minValue:a.y2,c.push(a.x+","+o.y.scale(n)),h.unshift(a.x+","+s.y.scale(r));return"M"+c.join("L")+"L"+h.join("L")+"Z"}},e.prototype.makeElement=function(t){var e="";return t.length?(t.$classify&&(e=Object.keys(t.$classify).join(" ")),'<path class="'+e+'" d="'+this.makePath(t)+'"></path>'):void 0},e}]),angular.module("vgraph").factory("DrawHeatmap",["DataBucketer",function(t){"use strict";function e(e,i,n,r,a){var o,s;this.area=i,this.templates=n,this.references=[e],a||(o=Object.keys(r),a={x:o[0],y:o[1]}),this.bucketer=s=new t(r[a.x],function(){return new t(r[a.y])})}return e.prototype.getReferences=function(){return this.references},e.prototype.parse=function(t){var e,i,n,r,a,o,s,c,h=this.references[0],l=[],u=[],f=this.area,p=this.bucketer;p.$reset(),t.forEach(function(t){p.push(h.$getNode(t))}),this.labels||(this.labels={}),this.labels.x?s=this.labels.x:(s={},p.$getIndexs().forEach(function(t){s[t]=t})),this.labels.y?c=this.labels.y:(c={},p.forEach(function(t){t.$getIndexs().forEach(function(t){c[t]=t})})),a=Object.keys(s).length+1,o=Object.keys(c).length+1,n=(f.x2-f.x1)/a,r=(f.y2-f.y1)/o,e=f.x1+n,Object.keys(s).forEach(function(t){var i=e+n;l.push({type:"x",x1:e,x2:i,y1:f.y1,y2:f.y1+r,width:n,height:r,text:s[t]}),e=i}),i=f.y1+r,Object.keys(c).forEach(function(t){var e=i+r;l.push({type:"y",x1:f.x1,x2:f.x1+n,y1:i,y2:e,width:n,height:r,text:c[t]}),i=e}),e=f.x1+n,Object.keys(s).forEach(function(t){var a=[],o=e+n;u.push(a),i=f.y1+r,Object.keys(c).forEach(function(s){var c=i+r,h=p.$getBucket(t).$getBucket(s);a.push(h),l.push({type:"cell",x1:e,x2:o,y1:i,y2:c,data:h,width:n,height:r}),i=c}),e=o}),l.$grid=u,this.dataSets=l},e.prototype.getLimits=function(){return null},e.prototype.closeSet=function(){},e.prototype.makePath=function(t){return t?"M"+(t.x1+","+t.y1)+"L"+(t.x2+","+t.y1)+"L"+(t.x2+","+t.y2)+"L"+(t.x1+","+t.y2)+"Z":void 0},e.prototype.makeElement=function(t){var e,i="";return t?(t.$classify&&(i=Object.keys(t.$classify).join(" ")),t.$className&&(i+=" "+t.$className),"cell"===t.type?(e=this.templates.cell,i+=" bucket"):(e="x"===t.type?this.templates.xHeading:this.templates.yHeading,i+=" heading axis-"+t.type),'<g class="'+i+'" transform="translate('+t.x1+","+t.y1+')"><rect x="0" y="0'+(t.$color?'" style="fill:'+t.$color:"")+'" width="'+(t.x2-t.x1)+'" height="'+(t.y2-t.y1)+'"/>'+e+"</g>"):void 0},e.prototype.getHitbox=function(t){return t},e}]),angular.module("vgraph").factory("DrawIcon",["DrawBox",function(t){"use strict";function e(t,e,i){this.top=t,this.bottom=t,this.references=[t],this.box=e,this.template=i}return e.prototype=new t,e.prototype.makeElement=function(t){var e,i;return t?(e=(t.x1+t.x2-this.box.width)/2,i=(t.y1+t.y2-this.box.height)/2,'<g transform="translate('+e+","+i+')">'+this.template+"</g>"):void 0},e}]),angular.module("vgraph").factory("DrawLine",["DrawLinear",function(t){"use strict";function e(t){var e=this.mergePoint;this.ref=t,this.references=[t],t.mergePoint&&(this.mergePoint=function(i,n){return t.mergePoint.call(this,i,n,e)})}function i(t,e){for(var i,n=e-1,r=t[e];t[n].$faux;)n--;for(i=(r.y-t[n].y)/(n-e),e-=1;e>n;e--)t[e].y=t[e+1].y+i;return n}var n=t.isNumeric;return e.prototype=new t,e.prototype.getPoint=function(t){var e=this.ref.$getNode(t);return{$classify:this.ref.classify?this.ref.classify(e):null,x:e.$x,y:this.ref.getValue(e)}},e.prototype.mergePoint=function(t,e){var i=t.x,r=t.y,a=e[e.length-1];return n(r)?(e.push({x:i,y:r}),-1):a&&void 0===r?(e.push({$faux:!0,x:i,y:a.y}),-1):0},e.prototype.closeSet=function(t){for(var e;t[t.length-1].$faux;)t.pop();for(e=t.length-1;e>-1;e--)t[e].$faux&&(e=i(t,e+1));return t},e.prototype.makePath=function(t){var e,i,n,r=[];if(t.length){for(e=0,i=t.length;i>e;e++)n=t[e],r.push(n.x+","+this.ref.$view.y.scale(n.y));return"M"+r.join("L")}},e.prototype.makeElement=function(t){var e="";return t.length?(t.$classify&&(e=Object.keys(t.$classify).join(" ")),'<path class="'+e+'" d="'+this.makePath(t)+'"></path>'):void 0},e}]),angular.module("vgraph").factory("DrawLinear",[function(){"use strict";function t(){this.references=[]}return t.isNumeric=function(t){return t||0===t},t.prototype.getReferences=function(){return this.references},t.prototype.makeSet=function(){return[]},t.prototype.mergePoint=function(t,e){return t?(e.push(e),!1):!0},t.prototype.isValidSet=function(t){return 0!==t.length},t.prototype.parse=function(t){function e(){o=s.mergePoint(a,c),1!==o&&a.$classify&&(c.$classify||(c.$classify={}),Object.keys(a.$classify).forEach(function(t){c.$classify[t]=!0}))}var i,n,r,a,o,s=this,c=this.makeSet(),h=[];for(i=0,n=t.length;n>i;i++)r=t[i],a=this.getPoint(r),a?e():o=0,o>-1&&(this.isValidSet(c)&&h.push(c),c=this.makeSet(),o&&e());this.isValidSet(c)&&h.push(c),this.dataSets=h},t.prototype.getLimits=function(){var t,e;return this.references.forEach(function(i){i.getValue&&i.$eachNode(function(n){var r=+i.getValue(n);(r||0===r)&&(void 0===t?(t=r,e=r):t>r?t=r:r>e&&(e=r))})}),{min:t,max:e}},t.prototype.closeSet=function(t){return t},t.prototype.makeElement=function(t){return console.log("makeElement",t),"<text>Element not overriden</text>"},t.prototype.makePath=function(t){return console.log("makePath",t),"M0,0Z"},t}]),angular.module("vgraph").factory("DrawPie",[function(){"use strict";function t(t,e,i,n){var r=(n-90)*Math.PI/180;return{x:t+i*Math.cos(r),y:e+i*Math.sin(r)}}function e(t,e,i,n,r,a){var o=a?"1":"0";return"M"+t+","+e+"L"+n.x+","+n.y+"A"+i+","+i+" 0 "+o+" 0 "+r.x+","+r.y+"Z"}function i(t,e,i){function n(e,n){var r=i(e,n);return void 0!==r?{bucket:t,value:r}:void 0}return e?function(t,i){return n(t,i)||e(t,i)}:n}function n(t,e,n){var r;this.area=n,this.buckets=Object.keys(e),this.references=[t],this.buckets.forEach(function(t){r=i(t,r,e[t])}),this.getPoint=function(e){var i=t.$getNode(e);return r(i,t.getValue(i))}}function r(t,e,i){return t>e&&t>i?t:e>i?e:i}function a(t,e,i){return e>t&&i>t?t:i>e?e:i}function o(t,e,i,n,o,s,c){var h=t,l=t,u=e,f=e;return(0===o||360===c)&&(u=e-i),90>=o&&c>=90&&(l=t+i),180>o&&c>=180&&(f=e+i),270>=o&&c>=270&&(h=t-i),{minX:a(h,n.x,s.x),maxX:r(l,n.x,s.x),minY:a(u,n.y,s.y),maxY:r(f,n.y,s.y)}}return n.prototype.getReferences=function(){return this.references},n.prototype.parse=function(t){var e,i,n,r=[],a=0,o={};for(e=0,i=t.length;i>e;e++)n=this.getPoint(t[e]),n&&(o[n.bucket]?o[n.bucket]+=n.value:o[n.bucket]=n.value);Object.keys(o).forEach(function(t){var e=a,i=o[t];a+=i,r.push({value:i,bucket:t,start:e,stop:a})}),r.forEach(function(t){t.total=a}),this.dataSets=r},n.prototype.makePath=function(i){var n=this.area.x||0,r=this.area.y||0,a=this.area.radius||1,o=i.start/i.total*360,s=i.stop/i.total*360,c=t(n,r,a,s),h=t(n,r,a,o),l=s-o>180;return i.value?(i.$start=c,i.$startAngle=o,i.$stop=h,i.$stopAngle=s,0===o&&360===s?e(n,r,a,t(n,r,a,0),t(n,r,a,180),l)+e(n,r,a,t(n,r,a,180),t(n,r,a,360),l):e(n,r,a,c,h,l)):void 0},n.prototype.getLimits=function(){return null},n.prototype.closeSet=function(){},n.prototype.makeElement=function(t){var e=t.bucket;return t.value?'<path class="slice '+e+'" d="'+this.makePath(t)+'"/>':void 0},n.prototype.getHitbox=function(t){var e=this.area.x||0,i=this.area.y||0,n=t.$startAngle,r=t.$stopAngle,a=this.area.radius||1,s=o(e,i,a,t.$start,n,t.$stop,r);return t.x1=s.minX,t.x2=s.maxX,t.y1=s.minY,t.y2=s.maxY,t.intersect=function(t,o){var s,c=t-e,h=o-i;return Math.sqrt(Math.pow(c,2)+Math.pow(h,2))<=a?(s=180*Math.atan(h/c)/Math.PI,s=t===e?i>o?0:180:o===i?e>t?270:90:t>e?i>o?90+s:90+s:270+s,s>=n&&r>=s):!1},t},n}]),angular.module("vgraph").directive("vgraphAxis",[function(){"use strict";function t(t,e){return!(t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}return{scope:{orient:"=vgraphAxis",adjust:"=axisAdjust",rotation:"=tickRotation"},require:["^vgraphChart"],link:function(e,i,n,r){function a(){N.attr("visibility","hidden")}var o,s,c,h,l,u,f,p,d,g,m,v=r[0],y=v.getView(n.view||"default"),x=v.box,$=d3.svg.axis(),b="axis",w=0,k=null,C=!0,E=!1,P=parseInt(n.tickLength)||0,_=parseInt(n.tickPadding)||3,z=parseInt(n.tickMargin)||0,N=d3.select(i[0]);switch(N.attr("visibility","hidden"),u=N.append("g").attr("class","ticks"),g=N.append("g").attr("class","padding"),f=g.append("g").attr("class","tick-marks"),p=g.append("rect").attr("class","tick-margin"),m=N.append("g").attr("class","label-wrap"),n.tickRotation&&(k=parseInt(n.tickRotation,10)%360),n.labelOffset&&(w=e.$eval(n.labelOffset)),n.labelClean&&(C=e.$eval(n.labelClean)),n.labelEndpoints&&(E=e.$eval(n.labelEndpoints)),n.axisLabel&&(d=m.append("text").attr("class","axis-label label"),e.$parent.$watch(n.axisLabel,function(t){d.text(t)})),s=function(){n.tickMarks?($.tickValues(e.$eval(n.tickMarks)),l=[]):n.tickCount?($.ticks(e.$eval(n.tickCount)),l=[]):($.ticks(10),l=[])},e.orient){case"top":o=function(){var t;if(N.attr("class",b+" x top").attr("transform","translate("+x.left+","+(x.top-P)+")").attr("width",x.width).attr("height",x.padding.top),d&&d.attr("text-anchor","middle").attr("x",x.width/2).attr("y",x.padding.top-w),z&&p.attr("height",z).attr("width",x.inner.width).attr("x",0).attr("y",-z),f.attr("transform","translate(-"+x.margin.left+",0)"),l&&($.orient("top").tickFormat(y.x.format).innerTickSize(-(x.inner.height+P+z)).outerTickSize(0).tickPadding(_+P+z).scale(y.x.scale),y.x.tick&&$.ticks(y.x.tick.interval,y.x.tick.step),u.attr("transform","translate(-"+x.margin.left+","+x.padding.top+")").call($),t=N.selectAll("g.axis-cap").data(y.x.scale.domain()),E&&(t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate("+(y.x.scale(t)-x.margin.left)+",0)"}).select("text").text(function(t){var e=y.x.format(t);return(""+e).match("NaN")?"":e}).attr("dy","-0.25em").attr("y",x.padding.top).attr("text-anchor","middle")),k)){if(null===u.select(".tick text")[0][0])return;u.selectAll(".tick text").attr("transform","translate(0,"+u.select(".tick text").attr("y")+") rotate("+k+",0,0)").attr("y","0").style("text-anchor",k%360>0?"end":"start"),t.select("text").attr("transform","rotate("+k+",0,0)").style("text-anchor",e.rotation%360>0?"end":"start")}};break;case"bottom":o=function(){var t;if(N.attr("class",b+" x bottom").attr("transform","translate("+x.left+","+x.inner.bottom+")").attr("width",x.width).attr("height",x.padding.bottom),d&&d.attr("text-anchor","middle").attr("x",x.width/2).attr("y",x.padding.bottom+w),z&&p.attr("height",z).attr("width",x.inner.width).attr("x",0).attr("y",0),f.attr("transform","translate(-"+x.margin.left+",0)"),l&&($.orient("bottom").tickFormat(y.x.format).innerTickSize(x.inner.height+P+z).outerTickSize(0).tickPadding(_+P+z).scale(y.x.scale),y.x.tick&&$.ticks(y.x.tick.interval,y.x.tick.step),u.attr("transform","translate(-"+x.margin.left+","+-x.inner.height+")").call($),t=N.selectAll("g.axis-cap").data(y.x.scale.domain()),E&&(t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate("+(y.x.scale(t)-x.margin.left)+",0)"}).select("text").text(function(t){var e=y.x.format(t);return(""+e).match("NaN")?"":e}).attr("dy","1em").attr("y",0).attr("text-anchor","middle")),k)){if(null===u.select(".tick text")[0][0])return;u.selectAll(".tick text").attr("transform",function(){return"translate(0,"+d3.select(this).attr("y")+") rotate("+k+",0,0)"}).attr("y","0").style("text-anchor",k%360>0?"start":"end"),t.select("text").attr("transform","rotate("+k+",0,0)").style("text-anchor",e.rotation%360>0?"start":"end")}};break;case"right":o=function(){var t;N.attr("class",b+" y right").attr("transform","translate("+P+","+x.top+")").attr("width",x.padding.right).attr("height",x.height),m.attr("transform","translate("+(x.right-x.padding.right)+","+x.height+") rotate( 90 )"),d&&d.attr("text-anchor","middle").attr("x",-(x.height/2)).attr("y",-w),z&&p.attr("height",x.inner.height).attr("width",z).attr("x",-z).attr("y",0),f.attr("transform","translate(-"+x.padding.right+","+(-x.top||0)+")"),l&&($.orient("right").tickFormat(y.y.format).innerTickSize(-(x.inner.width+P+z)).outerTickSize(0).tickPadding(_+P+z).scale(y.y.scale),y.y.tick&&$.ticks(y.y.tick.interval,y.y.tick.step),u.attr("transform","translate("+x.inner.right+","+(-x.top||0)+")"),u.call($),u.select(".domain").attr("transform","translate("+(P+z)+",0)"),E&&(t=N.selectAll("g.axis-cap").data(y.y.scale.domain()),t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate(0,"+(y.y.scale(t)-x.margin.top)+")"}).select("text").text(function(t){var e=y.y.format(t);return(""+e).match("NaN")?"":e}).attr("dy",".25em").attr("x",x.padding.left-$.tickPadding()).attr("text-anchor","end")))};break;case"left":o=function(){var t;N.attr("class",b+" y left").attr("transform","translate("+x.left+","+x.top+")").attr("width",x.padding.left).attr("height",x.height),m.attr("transform","translate("+x.padding.left+","+x.height+") rotate( -90 )"),d&&d.attr("text-anchor","middle").attr("x",x.height/2).attr("y",-w),z&&p.attr("height",x.inner.height).attr("width",z).attr("x",-z).attr("y",0),f.attr("transform","translate("+x.padding.left+","+(-x.top||0)+")"),l&&($.orient("left").tickFormat(y.y.format).innerTickSize(-(x.inner.width+P+z)).outerTickSize(0).tickPadding(_+P+z).scale(y.y.scale),y.y.tick&&$.ticks(y.y.tick.interval,y.y.tick.step),u.attr("transform","translate("+(x.padding.left-P-z)+","+(-x.top||0)+")").call($),u.select(".domain").attr("transform","translate("+(P+z)+",0)"),E&&(t=N.selectAll("g.axis-cap").data(y.y.scale.domain()),t.enter().append("g").attr("class",function(t,e){return"axis-cap "+(e?"axis-max":"axis-min")}).append("text"),t.exit().remove(),t.attr("transform",function(t){return"translate(0,"+(y.y.scale(t)-x.margin.top)+")"}).select("text").text(function(t){var e=y.y.format(t);return(""+e).match("NaN")?"":e}).attr("dy",".25em").attr("x",x.padding.left-$.tickPadding()).attr("text-anchor","end")))}}e.$on("$destroy",v.$subscribe({error:a,loading:a})),v.registerComponent({build:function(){void 0===l&&s(),o()},process:function(){l.length=0,P&&(u.selectAll(".tick text").each(function(t){l.push({el:this,val:t,position:this.getBoundingClientRect()})}),l.sort(function(t,e){var i=t.position.top-e.position.top;return i?i:t.position.left-e.position.left})),C&&(c=N.select(".axis-min text").node(),c&&(c=c.getBoundingClientRect()),h=N.select(".axis-max text").node(),h&&(h=h.getBoundingClientRect()))},finalize:function(){var e,i,n,r,a,o,s=y.filtered,u={};if(!s||!s.length)return void N.attr("visibility","hidden");for(N.attr("visibility",""),f.selectAll("line").remove(),r=0,a=l.length;a>r;r++)e=!0,i=l[r],n=i.position,C&&c&&(t(n,c)||t(n,h))?(i.el.setAttribute("class","collided"),e=!1):void 0===u.left?(u.left=n.left,u.right=n.right,u.width=n.width,u.top=n.top,u.bottom=n.bottom,u.height=n.height,i.el.setAttribute("class","")):C&&t(n,u)?(i.el.setAttribute("class","collided"),e=!1):(o=!1,n.left<u.left&&(u.left=n.left,o=!0),n.right>u.right&&(u.right=n.right,o=!0),o&&(u.width=u.right-u.left,o=!1),n.top<u.top&&(u.top=n.top,o=!0),n.bottom>u.bottom&&(u.bottom=n.bottom,o=!0),o&&(u.height=u.bottom-u.top),i.el.setAttribute("class",""))}},"axis-"+e.orient)}}}]),angular.module("vgraph").directive("vgraphBar",["DrawBar","ComponentElement",function(t,e){"use strict";return{scope:{config:"=vgraphBar",pair:"=?pair"},require:["^vgraphChart","vgraphBar"],controller:e,link:function(e,i,n,r){var a=i[0],o=r[0],s=r[1],c="bar ";s.setChart(o),s.setElement(a),e.$watch("config",function(i){var r=o.compileReference(i),h=o.compileReference(e.pair);r&&(s.setDrawer(new t(r,h,n.width)),r.classExtend&&(c+=r.classExtend+" "),c+=n.className||r.className,a.setAttribute("class",c),r.$view.registerComponent(s))})}}}]),angular.module("vgraph").directive("vgraphBox",["DrawBox","ComponentElement",function(t,e){"use strict";return{scope:{config:"=vgraphBox"},require:["^vgraphChart","vgraphBox"],controller:e,link:function(e,i,n,r){var a=i[0],o=r[0],s=r[1],c="box ";s.setChart(o),s.setElement(a),e.$watch("config",function(e){var i=o.compileReference(e);i&&(s.setDrawer(new t(i)),i.classExtend&&(c+=i.classExtend+" "),c+=n.className||i.className,a.setAttribute("class",c),i.$view.registerComponent(s))})}}}]),angular.module("vgraph").directive("vgraphCandlestick",["DrawCandlestick","DrawFill","ComponentElement",function(t,e,i){"use strict";return{scope:{config:"=vgraphCandlestick"},require:["^vgraphChart","vgraphCandlestick"],controller:i,link:function(e,i,n,r){var a,o=i[0],s=r[0],c=r[1];c.setChart(s),c.setElement(o),e.$watch("config",function(e){var i=s.compileReference(e);i&&(a="candlestick ",c.setDrawer(new t(i)),i.classExtend&&(a+=i.classExtend+" "),a+=n.className||i.className,o.setAttribute("class",a),i.$view.registerComponent(c))})}}}]),angular.module("vgraph").directive("vgraphChart",["ComponentChart",function(t){"use strict";function e(t){t.$mat&&t.inner.width&&(t.$mat.attr("class","mat").attr("width",t.inner.width).attr("height",t.inner.height).attr("transform","translate("+t.inner.left+","+t.inner.top+")"),t.$frame.attr("class","frame").attr("width",t.width).attr("height",t.height).attr("transform","translate("+t.left+","+t.top+")"))}return{scope:{settings:"=vgraphChart","interface":"=?interface"},controller:t,require:["vgraphChart","^vgraphPage"],link:function(t,i,n,r){var a,o=r[1],s=r[0],c=s.box;a="svg"===i[0].tagName?i[0]:i.find("svg")[0],s.$root=i[0],s.$svg=a,c.$on("resize",function(){e(c),s.rerender(function(){t.$apply()})}),c.targetSvg(a),c.$mat=d3.select(a).insert("rect",":first-child"),c.$frame=d3.select(a).insert("rect",":first-child"),e(c),t.$watch("settings",function(t){s.configure(o,t)}),t["interface"]&&(t["interface"].resize=c.resize.bind(c),t["interface"].error=s.error.bind(s)),n.name&&o.setChart(n.name,s)},restrict:"A"}}]),angular.module("vgraph").directive("vgraphCompare",["$compile","ComponentElement",function(t,e){"use strict";return{scope:{config1:"=config1",config2:"=config2"},require:["^vgraphChart"],link:function(i,n,r,a){var o,s=a[0],c=s.getReference(i.config1),h=s.getReference(i.config2),l=e.svgCompile('<g><path vgraph-line="config1" pair="config2" class-name="'+(r.className||"")+'"></path></g>')[0];n[0].appendChild(l),t(l)(i),o=s.$on("focus-point",function(t){var e=t[c.view],i=t[h.view],n=c.$view,a=h.$view,o=c.getValue(e),s=h.getValue(i);t[r.reference||"compare"]={value:Math.abs(o-s),y:(n.y.scale(o)+a.y.scale(s))/2,x:(e.$x+i.$x)/2}}),i.$on("$destroy",o)}}}]),angular.module("vgraph").directive("vgraphDots",["DrawDots","ComponentElement",function(t,e){"use strict";return{scope:{config:"=vgraphDots"},require:["^vgraphChart","vgraphDots"],controller:e,link:function(e,i,n,r){var a,o=i[0],s=r[0],c=r[1];c.setChart(s),c.setElement(o),e.$watch("config",function(e){var i=s.compileReference(e);i&&(c.setDrawer(new t(i,n.radius?parseInt(n.Radius,10):5)),a="point ",i.classExtend&&(a+=i.classExtend+" "),a+=n.className||i.className,o.setAttribute("class",a),i.$view.registerComponent(c))})}}}]),angular.module("vgraph").directive("vgraphExport",["makeBlob",function(t){"use strict";return{require:["^vgraphChart"],scope:{labels:"=?labels",exports:"=vgraphExport",options:"=?options",selected:"=?selected"},template:'<select ng-model="selected" ng-options="opt as (labels[opt] || opt) for opt in options"></select><a ng-click="process( exports[selected] )"><span>Export</span></a>',link:function(e,i,n,r){e.options||(e.options=Object.keys(e.exports)),e.selected||(e.selected=e.options[0]),e.process=function(e){var i=e(r[0]),n=t(i),a=document.createElement("a");a.setAttribute("href",window.URL.createObjectURL(n)),a.setAttribute("download",i.name),a.setAttribute("target","_blank"),document.getElementsByTagName("body")[0].appendChild(a),setTimeout(function(){a.click(),document.getElementsByTagName("body")[0].removeChild(a)},5)}}}}]),angular.module("vgraph").directive("vgraphFocus",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,n){var r=n[0],a=r.box,o=d3.select(e[0]),s=o.append("rect").attr("class","focus").attr("visibility","hidden");a.$on("resize",function(){s.attr("height",a.inner.height).attr("y",a.inner.top)}),r.$on("drag",function(t){var e,i,n;t&&void 0!==t.xDiff&&(e=Math.abs(t.xDiff),i=t.x0-e,n=t.x0+e,s.attr("visibility","visible"),i>a.inner.left?s.attr("x",i):(i=a.inner.left,s.attr("x",a.inner.left)),n>a.inner.right?s.attr("width",a.inner.right-i):s.attr("width",n-i))}),r.$on("drag-stop",function(t){var e,i,n,o,c;t&&(s.attr("visibility","hidden"),e=Math.abs(t.xDiff),e>3&&(i=t.x0-e,n=t.x0+e,i<a.inner.left?i=0:i-=a.inner.left,n>a.inner.right?n=a.inner.width:n-=a.inner.left,o=r.views[Object.keys(r.views)[0]].offset,c=a.inner.width*o.right-a.inner.width*o.left,r.zoom.setRatio((a.inner.width*o.left+i/a.inner.width*c)/a.inner.width,(a.inner.width*o.right-(a.inner.width-n)/a.inner.width*c)/a.inner.width)))})},scope:{follow:"=vgraphFocus",stop:"=loseFocus"}}}]),angular.module("vgraph").directive("vgraphHeatmap",["$compile","DrawHeatmap","ComponentElement",function(t,e,i){"use strict";return{scope:{config:"=vgraphHeatmap",indexs:"=indexs",calculate:"=calculator"},require:["^vgraphChart","vgraphHeatmap"],controller:i,link:function(i,n,r,a){function o(){h.x1=f.inner.left,h.x2=f.inner.right,
h.y1=f.inner.top,h.y2=f.inner.bottom}var s,c=n[0],h={},l=a[0],u=a[1],f=l.box,p="heatmap ",d=[],g={cell:c.getElementsByTagName("cell")[0].innerHTML.replace(/ng-binding/g,""),xHeading:c.getElementsByTagName("x-heading")[0].innerHTML.replace(/ng-binding/g,""),yHeading:c.getElementsByTagName("y-heading")[0].innerHTML.replace(/ng-binding/g,"")};c.innerHTML="",u.setChart(l,r.publish),u.setElement(c),o(),f.$on("resize",o),u._build=u.build,u.build=function(){d.forEach(function(t){t.$destroy()}),d=[],i.calculate&&i.calculate(this.drawer.dataSets),this._build()},u.onAppend=function(e,n){var r=i.$parent.$new();r.content=n,d.push(r),t(e)(r),r.$digest()},i.$watch("config",function(t){var n=l.compileReference(t);n&&(s=new e(n,h,g,i.indexs),u.setDrawer(s),n.classExtend&&(p+=n.classExtend+" "),p+=r.className||n.className,c.setAttribute("class",p),n.$view.registerComponent(u))})}}}]),angular.module("vgraph").directive("vgraphHighlight",[function(){"use strict";return{require:["^vgraphChart"],scope:!0,link:function(t,e,i,n){n[0].$on("highlight",function(e){t[i.vgraphHighlight]=e,t.$digest()})}}}]),angular.module("vgraph").directive("vgraphIcon",["DrawIcon","ComponentElement",function(t,e){"use strict";return{scope:{config:"=vgraphIcon"},require:["^vgraphChart","vgraphIcon"],controller:e,link:function(e,i,n,r){var a=i[0],o=d3.select(a),s=o.node().getBBox(),c=r[0],h=r[1],l=a.innerHTML,u="icon ",f=h.parse;h.parse=function(t){var e=f.call(this,t),i=s.height/2;return e.min-=i,e.max+=i,e},a.innerHTML="",h.setChart(c),h.setElement(a),e.$watch("config",function(e){var i=c.compileReference(e);i&&(h.setDrawer(new t(i,s,l)),i.classExtend&&(u+=i.classExtend+" "),u+=n.className||i.className,a.setAttribute("class",u),i.$view.registerComponent(h))})}}}]),angular.module("vgraph").directive("vgraphIndicator",[function(){"use strict";return{require:["^vgraphChart"],scope:{config:"=?vgraphIndicator"},link:function(t,e,i,n){function r(){l.attr("visibility","hidden")}var a,o,s=n[0],c=t.$eval(i.pointRadius)||3,h=t.$eval(i.outerRadius),l=d3.select(e[0]).attr("transform","translate(1000,1000)").attr("visibility","hidden"),u=l.append("circle").attr("r",c),f=l.append("circle").attr("r",c);t.$watch("config",function(t){t&&(a=s.getReference(t),u.attr("class","point inner "+a.className),f.attr("class","line outer "+a.className),h&&(o=function(){f.transition().duration(1e3).attr("r",h).transition().duration(1e3).attr("r",c).ease("sine").each("end",function(){setTimeout(function(){o()},3e3)})})())}),t.$on("$destroy",s.$subscribe({error:r,loading:r})),s.registerComponent({finalize:function(){var t,e,i=a.$view,n=i.getLeading(),o=a.getValue(n);o&&i.isLeading()?(t=n.$x,e=i.y.scale(o),t&&e&&(l.attr("transform","translate("+t+","+e+")"),l.attr("visibility","visible"))):r()}})}}}]),angular.module("vgraph").directive("vgraphInteract",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,n){var r,a,o=n[0],s=!1,c=o.box,h=d3.select(e[0]),l=h.append("rect").style("opacity","0").attr("class","focal").on("mousemove",function(){var t=d3.mouse(this);s||(clearTimeout(a),o.$trigger("focus",{x:t[0],y:t[1]}))}).on("mouseout",function(){s||(a=setTimeout(function(){o.$trigger("focus",null)},100))});h.attr("class","interactive"),h.call(d3.behavior.drag().on("dragstart",function(){r=d3.mouse(e[0]),s=!0,o.$trigger("focus",null),o.$trigger("drag-start",{x:r[0],y:r[1]})}).on("dragend",function(){var t=d3.mouse(e[0]);s=!1,o.$trigger("drag-stop",{x0:r[0],y0:r[1],x1:t[0],x2:t[1],xDiff:t[0]-r[0],yDiff:t[1]-r[1]})}).on("drag",function(){var t=d3.mouse(e[0]);o.$trigger("drag",{x0:r[0],y0:r[1],x1:t[0],x2:t[1],xDiff:t[0]-r[0],yDiff:t[1]-r[1]})})),h.on("dblclick",function(){o.zoom.setRatio(0,1)}),o.registerComponent({finalize:function(){l.attr({x:c.inner.left,y:c.inner.top,width:c.inner.width,height:c.inner.height})}})}}}]),angular.module("vgraph").directive("vgraphLabel",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,n){var r=n[0];r.box.$on("resize",function(){var t,n,a;a="inner"===i.vgraphLabel?r.box.inner:"padding"===i.vgraphLabel?r.box:r.box.outer,t="left"===i.x?a.left:"right"===i.x?a.right:r.box.center,n="top"===i.y?a.top:"bottom"===i.y?a.bottom:r.box.middle,e[0].setAttribute("transform","translate("+t+","+n+")")})}}}]),angular.module("vgraph").directive("vgraphLeading",[function(){"use strict";return{require:["^vgraphChart"],scope:{config:"=vgraphLeading"},link:function(t,e,i,n){function r(t){var e,i,n;if(s={},h.selectAll("line").remove(),o=[],t)for(i=0,n=t.length;n>i;i++)e=c.getReference(t[i]),o.push(e),s[e.name]=h.append("line").attr("class","line "+e.className)}function a(){h.attr("visibility","hidden")}var o,s,c=n[0],h=d3.select(e[0]);t.$watchCollection("config",r),t.$on("$destroy",c.$subscribe({error:a,loading:a})),c.registerComponent({finalize:function(){var t,e=!0,i=[];angular.forEach(o,function(t){var n=t.$view.normalizer,r=n.$latestNode(t.field),a=t.getValue(r);r&&t.$view.isLeading()?i.push({el:s[t.name],x:r.$x,y:t.$view.y.scale(a)}):(s[t.name].attr("visibility","hidden"),e=!1)}),i.sort(function(t,e){return t.y-e.y}),angular.forEach(i,function(e){t&&t.el.attr("visibility","visible").attr("x1",t.x).attr("x2",e.x).attr("y1",t.y).attr("y2",e.y),t=e}),t&&e?(h.attr("visibility","visible"),t.el.attr("visibility","visible").attr("x1",t.x).attr("x2",t.x).attr("y1",t.y).attr("y2",c.box.inner.bottom)):a()}})}}}]),angular.module("vgraph").directive("vgraphLine",["DrawLine","DrawFill","ComponentElement",function(t,e,i){"use strict";return{scope:{config:"=vgraphLine",pair:"=?pair"},require:["^vgraphChart","vgraphLine"],controller:i,link:function(i,n,r,a){var o,s=n[0],c=a[0],h=a[1];h.setChart(c),h.setElement(s),i.$watch("config",function(n){var a,l=c.compileReference(n);l&&(r.pair?(a=c.compileReference(i.pair),o="fill ",h.setDrawer(new e(l,a))):(o="line ",h.setDrawer(new t(l))),l.classExtend&&(o+=l.classExtend+" "),o+=r.className||l.className,s.setAttribute("class",o),l.$view.registerComponent(h))})}}}]),angular.module("vgraph").directive("vgraphLoading",["$interval",function(t){"use strict";return{require:["^vgraphChart"],link:function(e,i,n,r){function a(){!g&&d.loading&&($.text(d.message||"Loading Data"),v.attr("visibility","visible"),g=!0,t.cancel(l),s(),l=t(s,4005))}function o(){v.attr("visibility","hidden"),g=!1,t.cancel(l)}function s(){x.attr("x",function(){return u}).attr("width",function(){return 0}).transition().duration(1e3).attr("x",function(){return u}).attr("width",function(){return f}).ease("sine").transition().duration(1e3).attr("width",0).attr("x",function(){return p}).ease("sine").transition().duration(1e3).attr("width",function(){return f}).attr("x",function(){return u}).ease("sine").transition().duration(1e3).attr("x",function(){return u}).attr("width",0).ease("sine")}function c(){o(),d.loading&&m.ratio&&a()}var h,l,u,f,p,d=r[0],g=!1,m=d.box,v=d3.select(i[0]).attr("class","loading-view"),y=v.append("rect").attr("height",20).attr("class","outline"),x=v.append("rect").attr("width",0).attr("height",20).attr("class","filling"),$=v.append("text");m.$on("resize",function(){if(u=m.inner.left+m.inner.width/5,f=3*m.inner.width/5,p=u+f,f){x.attr("x",u).attr("y",m.middle-10),y.attr("x",u).attr("y",m.middle-10).attr("width",f);try{$.attr("text-anchor","middle").attr("x",m.center).attr("y",m.middle+$.node().getBBox().height/2-2)}catch(t){$.attr("text-anchor","middle").attr("x",m.center).attr("y",m.middle)}a()}else o()}),a(),h=d.$subscribe({error:c,rendered:c,configured:c}),e.$on("$destroy",function(){o(),h()})}}}]),angular.module("vgraph").directive("vgraphMessage",[function(){"use strict";return{require:["^vgraphChart"],link:function(t,e,i,n){function r(){var t=o.message;t&&!o.loading?(c.attr("visibility","visible"),l.text(t)):c.attr("visibility","hidden")}var a,o=n[0],s=o.box,c=d3.select(e[0]).attr("class","error-view"),h=c.append("rect").attr("class","outline"),l=c.append("text");c.attr("visibility","hidden"),s.$on("resize",function(){if(s.inner.height){h.attr("transform","translate("+s.inner.left+","+s.inner.top+")").attr("width",s.inner.width).attr("height",s.inner.height);try{l.attr("text-anchor","middle").attr("x",s.center).attr("y",s.middle+l.node().getBBox().height/2)}catch(t){l.attr("text-anchor","middle").attr("x",s.center).attr("y",s.middle)}}}),a=o.$subscribe({error:r,rendered:r,configured:r})}}}]),angular.module("vgraph").directive("vgraphPage",["ComponentPage",function(t){"use strict";return{restrict:"A",scope:{settings:"=vgraphPage"},controller:t,require:["vgraphPage"],link:function(t,e,i,n){var r=n[0];t.$watch("settings",function(t){r.configure(t)})}}}]),angular.module("vgraph").directive("vgraphPie",["DrawPie","ComponentElement",function(t,e){"use strict";return{scope:{config:"=vgraphPie",buckets:"=buckets"},require:["^vgraphChart","vgraphPie"],controller:e,link:function(e,i,n,r){function a(){s.radius=(h.inner.width<h.inner.height?h.inner.width:h.inner.height)/2,s.x=h.inner.left+h.inner.width/2,s.y=h.inner.top+h.inner.height/2}var o=i[0],s={},c=r[0],h=c.box,l=r[1],u="pie ";l.setChart(c,n.publish),l.setElement(o),a(),h.$on("resize",a),e.$watch("config",function(i){var r=c.compileReference(i);r&&(l.setDrawer(new t(r,e.buckets,s)),r.classExtend&&(u+=r.classExtend+" "),u+=n.className||r.className,o.setAttribute("class",u),r.$view.registerComponent(l))})}}}]),angular.module("vgraph").directive("vgraphPublish",[function(){"use strict";return{require:["^vgraphChart"],scope:!0,link:function(t,e,i,n){var r=t.$eval(i.vgraphPublish);Object.keys(r).forEach(function(e){n[0].$on("publish:"+e,function(i){t[r[e]]=i,t.$digest()})})}}}]),angular.module("vgraph").directive("vgraphStack",["$compile","ComponentElement","StatCalculations",function(t,e,i){"use strict";return{require:["^vgraphChart"],scope:{config:"=vgraphStack",feed:"=?feed"},link:function(t,e,n,r){function a(t){var e,i,n,r={};for(s=[],e=0,i=t.length;i>e;e++)n=l.getReference(t[e]),n.pair=r,r=n,s.push(n)}function o(t){t&&a(t)}var s,c,h,l=r[0];t.$watchCollection("config",o),c=t.$watchCollection("config",o),t.$on("$destroy",function(){h&&h.$destroy(),c()}),l.registerComponent({parse:function(){s&&(i.$resetCalcs(s),i.stack(s))}})}}}]),angular.module("vgraph").directive("vgraphStatus",[function(){"use strict";return{require:["^vgraphChart"],scope:!0,link:function(t,e,i,n){function r(){t[i.vgraphStatus]={message:a.message,loading:a.loading,pristine:a.pristine},t.$digest()}var a=n[0];a.$subscribe({error:r,success:r,configured:r})}}}]),angular.module("vgraph").directive("vgraphTarget",[function(){"use strict";return{require:["^vgraphChart"],scope:{pointRadius:"=pointRadius",config:"=vgraphTarget"},link:function(t,e,i,n){function r(e){e?(o=e.pos.x,h.style("visibility","visible").attr("transform","translate("+o+",0)"),void 0===i.noDots&&angular.forEach(a,function(n){var r,a=n.$view,s=e[n.view],c=n.className,h=n.getValue(s);void 0!==h&&null!==h?(r=u.selectAll("circle.point."+c),r[0].length||(r=u.append("circle").attr("class","point "+c+" "+n.classExtend)),r.attr("cx",s.$x-o).attr("cy",a.y.scale(h)).attr("r",t.$eval(i.pointRadius)||3)):u.selectAll("circle.point."+c).remove()})):h.style("visibility","hidden")}var a,o,s=n[0],c=s.box,h=d3.select(e[0]).attr("class","target"),l=h.append("line").attr("class","focus").attr("x1",0).attr("x2",0),u=h.append("g");h.style("visibility","hidden"),s.$on("highlight",r),c.$on("resize",function(){l.attr("y1",c.inner.top).attr("y2",c.inner.bottom)}),t.$watchCollection("config",function(t){var e,i;if(a=[],t)for(e=0,i=t.length;i>e;e++)t[e]&&a.push(s.getReference(t[e]))})}}}]),angular.module("vgraph").directive("vgraphTooltip",[function(){"use strict";function t(t,i,n){var r=i.config;return n.reference?{formatter:function(t){return t[n.reference].value},xParse:function(t){return t[n.reference].x},yParse:function(t){return t[n.reference].y}}:r.formatter?r:e(t,r)}function e(t,e){var i=t.getReference(e);return{formatter:function(t){return i.getValue(t[i.view])},xParse:function(t){return t[i.view].$x},yParse:function(t){return i.$view.y.scale(i.getValue(t[i.view]))}}}return{require:["^vgraphChart"],scope:{config:"=?vgraphTooltip"},link:function(e,i,n,r){var a=r[0],o=t(a,e,n),s=parseInt(n.offsetX)||0,c=parseInt(n.offsetY)||0,h=d3.select(i[0]).attr("class","tooltip"),l=h.append("polygon").attr("class","outline").attr("transform","translate(0,-15)"),u=h.append("text").style("line-height","20").style("font-size","16").attr("class","label");a.$on("highlight",function(t){var e,i,n,r;t&&(n=o.yParse(t)),void 0!==n?(e=n+c,i=o.xParse(t)+s,u.text(o.formatter(t)),r=u.node().getComputedTextLength()+5,h.style("visibility","visible"),i+r+16<a.box.inner.right?(h.attr("transform","translate("+i+","+e+")"),u.attr("transform","translate(10,5)"),l.attr("points","0,15 10,0 "+(r+10)+",0 "+(r+10)+",30 10,30 0,15")):(h.attr("transform","translate("+(i-2*s-r-10)+","+e+")"),u.attr("transform","translate(5,5)"),l.attr("points","0,0 "+r+",0 "+(r+10)+",15 "+r+",30 0,30 0,0"))):h.style("visibility","hidden")})}}}]),angular.module("vgraph").directive("vgraphZoom",[function(){"use strict";return{scope:{min:"=zoomMin",max:"=zoomMax"},require:["^vgraphChart","^vgraphPage"],link:function(t,e,i,n){function r(t){0===s&&c===g.inner.width?(y=!1,k.attr("class","focus")):(y=!0,k.attr("class","focus zoomed")),0>s&&(s=0),c>g.inner.width&&(c=g.inner.width),s>c?s=c:s>c&&(c=s),$.attr("transform","translate("+s+",0)"),b.attr("transform","translate(-"+s+",0 )").attr("width",s),C.attr("transform","translate("+c+",0)"),E.attr("width",g.inner.width-c),k.attr("transform","translate("+s+",0)").attr("width",c-s),t&&m.setRatio(s/g.inner.width,c/g.inner.width)}function a(){v||(s=m.left*g.inner.width,c=m.right*g.inner.width,r())}var o,s,c,h,l,u,f,p=n[0],d=n[1],g=p.box,m=d.getZoom(i.vgraphZoom),v=!1,y=!1,x=d3.select(e[0]),$=x.append("g").attr("class","left-control min-control"),b=$.append("rect").attr("class","shade"),w=$.append("g").attr("class","control"),k=x.append("rect").attr("class","focus"),C=x.append("g").attr("class","right-control max-control"),E=C.append("rect").attr("class","shade"),P=C.append("g").attr("class","control");l=w.append("path").attr("d","M-0.5,23.33A6,6 0 0 0 -6.5,29.33V40.66A6,6 0 0 0 -0.5,46.66ZM-2.5,31.33V38.66M-4.5,31.33V38.66").attr("transform","translate(0,-9)").attr("class","nub"),h=w.append("rect").attr("width","10").attr("transform","translate(-10,0)"),f=P.append("path").attr("d","M0.5,23.33A6,6 0 0 1 6.5,29.33V40.66A6,6 0 0 1 0.5,46.66ZM2.5,31.33V38.66M4.5,31.33V38.66").attr("transform","translate(0,-9)").attr("class","nub"),u=P.append("rect").attr("width","10"),t.box=g,h.call(d3.behavior.drag().on("dragstart",function(){v=!0}).on("dragend",function(){v=!1}).on("drag",function(){s=d3.mouse(e[0])[0],r(!0)})),u.call(d3.behavior.drag().on("dragstart",function(){v=!0}).on("dragend",function(){v=!1}).on("drag",function(){c=d3.mouse(e[0])[0],r(!0)})),k.call(d3.behavior.drag().on("dragstart",function(){o={mouse:d3.mouse(e[0])[0],minPos:s,maxPos:c},v=!0}).on("dragend",function(){v=!1,y=!0}).on("drag",function(){var t=d3.mouse(e[0]),i=t[0]-o.mouse;y?(c=o.maxPos+i,s=o.minPos+i,r(!0)):i>1&&(c=o.mouse+Math.abs(i),s=o.mouse-Math.abs(i),r(!0),y=!1)})),x.on("dblclick",function(){c=g.inner.width,s=0,r(!0)}),g.$on("resize",function(){x.attr("width",g.inner.width).attr("height",g.inner.height).attr("transform","translate("+g.inner.left+","+g.inner.top+")"),f.attr("transform","translate(0,"+(g.inner.height/2-30)+")"),l.attr("transform","translate(0,"+(g.inner.height/2-30)+")"),b.attr("height",g.inner.height),E.attr("height",g.inner.height),h.attr("height",g.inner.height),u.attr("height",g.inner.height),k.attr("height",g.inner.height),a()}),m.$on("update",a),a()}}}]),function(t){"use strict";var e=/\S+/g,i=/[\t\r\n\f]/g;t&&(t.fn.addClass=function(n){var r,a,o,s,c,h,l,u="string"==typeof n&&n,f=0,p=this.length;if(t.isFunction(n))return this.each(function(e){t(this).addClass(n.call(this,e,this.className))});if(u)for(r=(n||"").match(e)||[];p>f;f++)if(a=this[f],l="string"!=typeof a.className,o=1===a.nodeType&&(a.className?(" "+(l?a.getAttribute("class")||"":a.className)+" ").replace(i," "):" ")){for(c=0;s=r[c++];)o.indexOf(" "+s+" ")<0&&(o+=s+" ");h=t.trim(o),a.className!==h&&(l?a.setAttribute("class",h):a.className=h)}return this},t.fn.removeClass=function(n){var r,a,o,s,c,h,l,u=0===arguments.length||"string"==typeof n&&n,f=0,p=this.length;if(t.isFunction(n))return this.each(function(e){t(this).removeClass(n.call(this,e,this.className))});if(u)for(r=(n||"").match(e)||[];p>f;f++)if(a=this[f],l="string"!=typeof a.className,o=1===a.nodeType&&(a.className?(" "+(l?a.getAttribute("class")||"":a.className)+" ").replace(i," "):"")){for(c=0;s=r[c++];)for(;o.indexOf(" "+s+" ")>=0;)o=o.replace(" "+s+" "," ");h=n?t.trim(o):"",a.className!==h&&(l?a.setAttribute("class",h):a.className=h)}return this})}(jQuery);
//# sourceMappingURL=vgraph.min.js.map