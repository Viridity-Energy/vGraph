<html>

<head>
	<meta charset="utf-8">
 	<script src="bower_components/d3/d3.js"></script>
 	<script src="bower_components/jquery/dist/jquery.js"></script>
	<script src="bower_components/angular/angular.js"></script>
	<script src="vgraph.js"></script>
	<link href="vgraph.css" rel="stylesheet" type="text/css" />
</head>
<body ng-app="vgraph">

	<h1>Hello World</h1>
	<h5>Growing Graph</h5>
	<style>
		[ng-controller] {
			display : inline-block;
			width: 800;
			height: 220;
		}

		[vgraph-chart] {
			margin: 10px 30px;
			padding: 0px 0px 20px 40px;
			width: 740;
			height: 180;
		}

		.narrow [vgraph-chart] {
			width: 340;
			height: 90;
		}

		[vgraph-chart] .mat {
			fill: #ddd;
		}

		[vgraph-line="line"] {
			stroke: black;
    		stroke-width: 2;
    		fill: none;
		}

		line.red{
			stroke: red;
    		fill: none;
		}

		line.blue{
			stroke: blue;
			fill: none;
		}

		line.green{
			stroke: green;
			fill: none;
		}

		line.orange{
			stroke: orange;
			fill: none;
		}

		.red path{
			stroke: red;
    		fill: none;
		}

		.blue path{
			stroke: blue;
			fill: none;
		}

		.green path{
			stroke: green;
			fill: none;
		}

		.orange path{
			stroke: orange;
			fill: none;
		}

		.red.fill path, circle.red {
			stroke: red;
    		fill: red;
		}

		.blue.fill path, circle.blue {
			stroke: blue;
			fill: blue;
		}

		.green.fill path, circle.green {
			stroke: green;
			fill: green;
		}

		.orange.fill path, circle.orange {
			stroke: orange;
			fill: orange;
		}
	</style>

	<h5>Standard</h5>
	<div ng-controller="FloodCtrl">
		<svg vgraph-chart="box" model="model">
			<g vgraph-line="line" interval="'x'" 
				value="'y1'" name="someLine1"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y2'" name="someLine2"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y3'" name="someLine3"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y4'" name="someLine4"></g>
		</svg>
	</div>

	<div ng-controller="StackedCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-stack config="config"></g>
		</svg>
	</div>

	<div ng-controller="SpeedCtrl">
		<svg vgraph-chart="box" model="model">
			<g vgraph-line="line" interval="'x'" 
				value="'y1'" name="someLine1"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y2'" name="someLine2"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y3'" name="someLine3"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y4'" name="someLine4"></g>
		</svg>
	</div>

	<div ng-controller="GrowingCtrl">
		<svg vgraph-chart="box" model="model">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y'" name="someLine"></g>
			<g vgraph-indicator="someLine"
				point-radius="5"></g>
		</svg>
	</div>

	<div ng-controller="StaticCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-line="line" interval="'x'" 
				value="'y'" name="someLine"></g>
			<g vgraph-indicator="someLine"
				outer-radius="10"
				point-radius="5"></g>
		</svg>
	</div>

	<div ng-controller="MultiCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-multi-line="line" config="config"></g>
		</svg>
	</div>

	<div ng-controller="StackedClassCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-stack config="config"></g>
		</svg>
	</div>

	<h5>Raw Data</h5>

	<div ng-controller="RawCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-multi-line config="config"></g>
			<g vgraph-leading config="config"></g>
		</svg>
	</div>
	
	<h5>Classed - Multi Data Sources</h5>
	<div ng-controller="StackedMultiCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-stack config="config"></g>
			<g vgraph-target="highlight" point-radius="5" config="config"></g>
			<g vgraph-interact="highlight"></g>
		</svg>
	</div>
	
	<div ng-controller="ResizeCtrl">
		<svg xmlns="http://www.w3.org/2000/svg" vgraph-chart="box" model="model" version="1.1">
			<g vgraph-axis="'left'"
                tick-length="4" tick-padding="-2"></g>
            <g vgraph-axis="'bottom'"
                tick-length="4" tick-padding="-2" tick-rotation="-45"></g>
			<g vgraph-multi-line config="config"></g>
			<g vgraph-multi-indicator config="config"></g>
			<g vgraph-target="highlight" point-radius="5" config="config"></g>
			<g vgraph-interact="highlight"></g>
		</svg>
		<div>
			<button ng-click="resize()">Resize</button>
		</div>
	</div>

<script>

angular.module( 'vgraph' ).controller( 'ResizeCtrl', [
	'$scope', '$element', 'BoxModel', 'GraphModel',
	function( $scope, $element, BoxModel, GraphModel ){
		var data = [ { x : 0, y_line_1 : 10, y_line_2 : 5, y_line_3 : 15, y_line_4 : 8} ],
			interval,
			wide = true;

		$scope.highlight = {};
		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

		$scope.resize = function(){
			if ( wide ){
				$element.addClass('narrow');
				wide = false;
			} else {
				$element.removeClass('narrow');
				wide = true;
			}

			console.log( 'resizing...' );
			$scope.box.resize();
		};

		$scope.config = [
			{ name : 'y_line_1', className : 'red', data : 'line' },
			{ name : 'y_line_2', className : 'blue', data : 'line' },
			{ name : 'y_line_3', className : 'green', data : 'line' },
			{ name : 'y_line_4', className : 'orange', data : 'line' }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y_line_1 : data[data.length-1].y_line_1 + t,
					y_line_2 : data[data.length-1].y_line_2 + t,
					y_line_3 : data[data.length-1].y_line_3 + t,
					y_line_4 : data[data.length-1].y_line_4 + t
				};

			data.push( p );
		}
	}]
);

angular.module( 'vgraph' ).controller( 'FloodCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ {x : 0, y1 : 20, y2 : 25, y3 : 30, y4 : 40}  ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min;

			data.push({
				x : data.length,
				y1 : data[data.length-1].y1 + t,
				y2 : data[data.length-1].y2 + t,
				y3 : data[data.length-1].y3 + t,
				y4 : data[data.length-1].y4 + t
			});
		}
		
		$scope.model.setBounds({
                min : null,
                max : null
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'MultiCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ { y1 : 10, y2 : 5, y3 : 15, y4 : 8} ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

        // x is the interval, y is the function pulling the value
		$scope.config = [
			{ name : 'y_1', color : 'red', x : function( d ){ return d.x }, y : function( d ){ return d.y1 } },
			{ name : 'y_2', color : 'blue', x : function( d ){ return d.x }, y : function( d ){ return d.y2 }  },
			{ name : 'y_3', color : 'green', x : function( d ){ return d.x }, y : function( d ){ return d.y3 }  },
			{ name : 'y_4', color : 'orange', x : function( d ){ return d.x }, y : function( d ){ return d.y4 }  }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y1 : data[data.length-1].y1 + t,
					y2 : data[data.length-1].y2 + t,
					y3 : data[data.length-1].y3 + t,
					y4 : data[data.length-1].y4 + t
				};

			data.push( p );
		}

		$scope.model.dataReady( $scope );
		$scope.model.setBounds({
                min : null,
                max : null
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'RawCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ { y1 : 15, y2 : 5, y3 : 25, y4 : 35} ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

        // x is the interval, y is the function pulling the value
		$scope.config = [
			{ name : 'y_1', data: data, className : 'red', value : 'y1' },
			{ name : 'y_2', data: data, className : 'blue', value : 'y2'  },
			{ name : 'y_3', data: data, className : 'green', value : 'y3'  },
			{ name : 'y_4', data: data, className : 'orange', value : 'y4'  }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y1 : data[data.length-1].y1 + t,
					y2 : data[data.length-1].y2 + t,
					y3 : data[data.length-1].y3 + t,
					y4 : data[data.length-1].y4 + t
				};

			data.push( p );
		}

		$scope.model.setBounds({
                min : 0,
                max : 2500
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'StackedCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ { y1 : 10, y2 : 5, y3 : 15, y4 : 8} ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });
		$scope.config = [
			{ name : 'y1', color : 'red' },
			{ name : 'y2', color : 'blue' },
			{ name : 'y3', color : 'green' },
			{ name : 'y4', color : 'orange' }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y1 : data[data.length-1].y1 + t,
					y2 : data[data.length-1].y2 + t,
					y3 : data[data.length-1].y3 + t,
					y4 : data[data.length-1].y4 + t
				};

			data.push( p );

			$scope.model.addPoint( 'y1', p.x, p.y1 );
			$scope.model.addPoint( 'y2', p.x, p.y2 );
			$scope.model.addPoint( 'y3', p.x, p.y3 );
			$scope.model.addPoint( 'y4', p.x, p.y4 );
		}

		$scope.model.dataReady( $scope );
		$scope.model.setBounds({
                min : null,
                max : null
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'StackedMultiCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ { y1 : 10, y2 : 5, y3 : 15, diff : 8} ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });
		$scope.config = [
			{ name : 'y1', color : 'red', data : 'line' },
			{ name : 'y2', color : 'blue', data : 'line' },
			{ name : 'y3', color : 'green', data : 'line' },
			{ name : 'y4', color : 'orange', data : 'line', value : 'diff', interval : 'xDiff' }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y1 : data[data.length-1].y1 + t,
					y2 : data[data.length-1].y2 + t,
					y3 : data[data.length-1].y3 + t,
					xDiff : data.length,
					diff : data[data.length-1].diff + t
				};

			data.push( p );
		}

		$scope.model.dataReady( $scope );
		$scope.model.setBounds({
                min : null,
                max : null
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'StackedClassCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ { y1 : 10, y2 : 5, y3 : 15, y4 : 8} ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });
		$scope.config = [
			{ name : 'y1', className : 'red' },
			{ name : 'y2', className : 'blue' },
			{ name : 'y3', className : 'green' },
			{ name : 'y4', className : 'orange' }
		];

		for( var i = 0, c = 2000; i < c; i++ ){
			var counter = 0;
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min,
				p = {
					x : data.length,
					y1 : data[data.length-1].y1 + t,
					y2 : data[data.length-1].y2 + t,
					y3 : data[data.length-1].y3 + t,
					y4 : data[data.length-1].y4 + t
				};

			data.push( p );

			$scope.model.addPoint( 'y1', p.x, p.y1 );
			$scope.model.addPoint( 'y2', p.x, p.y2 );
			$scope.model.addPoint( 'y3', p.x, p.y3 );
			$scope.model.addPoint( 'y4', p.x, p.y4 );
		}

		$scope.model.dataReady( $scope );
		$scope.model.setBounds({
                min : null,
                max : null
            },{
                min : null,
                max : null
            })
            .setPane({
                start : null,
                stop : null
            },{
                start : null,
                stop : null
            });
	}]
);

angular.module( 'vgraph' ).controller( 'SpeedCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ {x : 0, y1 : 20, y2 : 25, y3 : 30, y4 : 40}  ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

		var counter = 0;
		interval = setInterval(function(){
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min;

			data.push({
				x : data.length,
				y1 : data[data.length-1].y1 + t,
				y2 : data[data.length-1].y2 + t,
				y3 : data[data.length-1].y3 + t,
				y4 : data[data.length-1].y4 + t
			});

			$scope.model.setBounds({
                    min : null,
                    max : null
                },{
                    min : null,
                    max : null
                })
                .setPane({
                    start : null,
                    stop : null
                },{
                    start : null,
                    stop : null
                });

			$scope.$apply();
		}, 20);

		setTimeout(function(){
			clearInterval( interval );
		}, 20000 );
	}]
);

angular.module( 'vgraph' ).controller( 'GrowingCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ {x : 0, y : 20}  ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

		interval = setInterval(function(){
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min;

			data.push({
				x : data.length,
				y : data[data.length-1].y + t
			});

			$scope.model.setBounds({
                    min : null,
                    max : null
                },{
                    min : null,
                    max : null
                })
                .setPane({
                    start : null,
                    stop : null
                },{
                    start : null,
                    stop : null
                });

			$scope.$apply();
		}, 20);

		setTimeout(function(){
			clearInterval( interval );
		}, 20000 );
	}]
);

angular.module( 'vgraph' ).controller( 'StaticCtrl',
	['$scope', 'BoxModel', 'GraphModel',
	function( $scope, BoxModel, GraphModel ){
		var data = [ {x : 0, y : 20}  ],
			interval,
			boxModel;

		$scope.line = data;
		$scope.box = new BoxModel();
		$scope.model = new GraphModel({
            x : {
                scale : function(){
                    return d3.scale.linear();
                }
            },
            y : {
                padding : 0.05
            }
        });

		interval = setInterval(function(){
			var min = -1,
				max = 1,
				t = Math.random() * (max - min) + min;

			data.push({
				x : data.length,
				y : data[data.length-1].y + t
			});

			$scope.model.setBounds({
                    min : 0,
                    max : 1000
                },{
                    min : null,
                    max : null
                })
                .setPane({
                    start : null,
                    stop : null
                },{
                    start : null,
                    stop : null
                });

			$scope.$apply();
		}, 20);

		setTimeout(function(){
			clearInterval( interval );
		}, 20000 );
	}]
);
</script>

</body>

</html>
